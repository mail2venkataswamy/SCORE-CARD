(function (global, factory) {
    typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, require('@angular/core'), require('rxjs'), require('rxjs/operators'), require('@angular/common'), require('ng-wormhole')) :
    typeof define === 'function' && define.amd ? define('angular-dropdown', ['exports', '@angular/core', 'rxjs', 'rxjs/operators', '@angular/common', 'ng-wormhole'], factory) :
    (factory((global['angular-dropdown'] = {}),global.ng.core,global.rxjs,global.rxjs.operators,global.ng.common,global.ngWormhole));
}(this, (function (exports,core,rxjs,operators,common,ngWormhole) { 'use strict';

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
     */
    var AngularDropdownControlDirective = /** @class */ (function () {
        function AngularDropdownControlDirective(dropdown, element) {
            this.dropdown = dropdown;
            this.element = element;
            this.isDropdownOpen = false;
        }
        /**
         * @param {?} e
         * @return {?}
         */
        AngularDropdownControlDirective.prototype.onClick = /**
         * @param {?} e
         * @return {?}
         */
            function (e) {
                e.stopPropagation();
                if (!this.dropdown.disabled) {
                    this.dropdown.toggle();
                }
            };
        /**
         * @return {?}
         */
        AngularDropdownControlDirective.prototype.ngOnInit = /**
         * @return {?}
         */
            function () {
                var _this = this;
                this.dropdownStateSubscription = this.dropdown.isOpen$.subscribe(function (isOpen) { return (_this.isDropdownOpen = isOpen); });
            };
        /**
         * @return {?}
         */
        AngularDropdownControlDirective.prototype.ngOnDestroy = /**
         * @return {?}
         */
            function () {
                this.dropdownStateSubscription && this.dropdownStateSubscription.unsubscribe();
            };
        AngularDropdownControlDirective.decorators = [
            { type: core.Directive, args: [{
                        selector: '[ng-dropdown-control],[ngDropdownControl]',
                        host: {
                            '[attr.aria-haspopup]': 'true',
                            '[attr.aria-controls]': 'dropdown.id',
                            '[attr.aria-expanded]': 'isDropdownOpen',
                            '[class.ng-dropdown-control]': 'true',
                            '[class.active]': 'isDropdownOpen'
                        }
                    },] }
        ];
        AngularDropdownControlDirective.ctorParameters = function () {
            return [
                { type: AngularDropdownDirective, decorators: [{ type: core.Host }, { type: core.Inject, args: [core.forwardRef(function () { return AngularDropdownDirective; }),] }] },
                { type: core.ElementRef }
            ];
        };
        AngularDropdownControlDirective.propDecorators = {
            onClick: [{ type: core.HostListener, args: ['click', ['$event'],] }]
        };
        return AngularDropdownControlDirective;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
     */
    /**
     * @param {?} element
     * @param {?} callback
     * @return {?}
     */
    function waitForAnimation(element, callback) {
        if (element === null) {
            return;
        }
        requestAnimationFrame(function () {
            /** @type {?} */
            var computedStyle = window.getComputedStyle(element);
            if (computedStyle.animationName !== 'none' &&
                computedStyle.animationPlayState === 'running') {
                return once(element, 'animationend', callback);
            }
            callback();
        });
    }
    /**
     * @param {?} element
     * @param {?} eventName
     * @param {?} listener
     * @return {?}
     */
    function once(element, eventName, listener) {
        element.addEventListener(eventName, function listenOnce(e) {
            element.removeEventListener(eventName, listenOnce);
            return listener(e);
        });
    }
    /** @type {?} */
    var closest = typeof Element != 'undefined' && Element.prototype.closest
        ? function (el, s) { return el.closest(s); }
        : function _closest(self, s) {
            /** @type {?} */
            var matches = ((( /** @type {?} */(self))).document || self.ownerDocument).querySelectorAll(s);
            /** @type {?} */
            var i;
            /** @type {?} */
            var el = self;
            do {
                i = matches.length;
                while (--i >= 0 && matches.item(i) !== el) { }
            } while (i < 0 && (el = el.parentElement));
            return el;
        };
    /**
     * @param {?} trigger
     * @param {?} dropdown
     * @param {?} __2
     * @return {?}
     */
    function calculatePosition(trigger, dropdown, _a) {
        var horizontalPosition = _a.horizontalPosition, verticalPosition = _a.verticalPosition, matchTriggerWidth = _a.matchTriggerWidth, previousHorizontalPosition = _a.previousHorizontalPosition, previousVerticalPosition = _a.previousVerticalPosition;
        // Collect information about all the involved DOM elements
        /** @type {?} */
        var scroll = { left: window.pageXOffset, top: window.pageYOffset };
        var _b = trigger.getBoundingClientRect(), triggerLeft = _b.left, triggerTop = _b.top, triggerWidth = _b.width, triggerHeight = _b.height;
        var _c = dropdown.getBoundingClientRect(), dropdownHeight = _c.height, dropdownWidth = _c.width;
        /** @type {?} */
        var viewportWidth = window.innerWidth;
        /** @type {?} */
        var style = {};
        // Calculate drop down width
        dropdownWidth = matchTriggerWidth ? triggerWidth : dropdownWidth;
        if (matchTriggerWidth) {
            style.width = dropdownWidth;
        }
        // Calculate horizontal position
        /** @type {?} */
        var triggerLeftWithScroll = triggerLeft + scroll.left;
        if (horizontalPosition === 'auto') {
            // Calculate the number of visible horizontal pixels if we were to place the
            // dropdown on the left and right
            /** @type {?} */
            var leftVisible = Math.min(viewportWidth, triggerLeft + dropdownWidth) -
                Math.max(0, triggerLeft);
            /** @type {?} */
            var rightVisible = Math.min(viewportWidth, triggerLeft + triggerWidth) -
                Math.max(0, triggerLeft + triggerWidth - dropdownWidth);
            if (dropdownWidth > leftVisible && rightVisible > leftVisible) {
                // If the drop down won't fit left-aligned, and there is more space on the
                // right than on the left, then force right-aligned
                horizontalPosition = 'right';
            }
            else if (dropdownWidth > rightVisible && leftVisible > rightVisible) {
                // If the drop down won't fit right-aligned, and there is more space on
                // the left than on the right, then force left-aligned
                horizontalPosition = 'left';
            }
            else {
                // Keep same position as previous
                horizontalPosition = previousHorizontalPosition || 'left';
            }
        }
        if (horizontalPosition === 'right') {
            style.right = viewportWidth - (triggerLeftWithScroll + triggerWidth);
        }
        else if (horizontalPosition === 'center') {
            style.left = triggerLeftWithScroll + (triggerWidth - dropdownWidth) / 2;
        }
        else {
            style.left = triggerLeftWithScroll;
        }
        // Calculate vertical position
        /** @type {?} */
        var triggerTopWithScroll = triggerTop + scroll.top;
        if (verticalPosition === 'above') {
            style.top = triggerTopWithScroll - dropdownHeight;
        }
        else if (verticalPosition === 'below') {
            style.top = triggerTopWithScroll + triggerHeight;
        }
        else {
            /** @type {?} */
            var viewportBottom = scroll.top + self.window.innerHeight;
            /** @type {?} */
            var enoughRoomBelow = triggerTopWithScroll + triggerHeight + dropdownHeight < viewportBottom;
            /** @type {?} */
            var enoughRoomAbove = triggerTop > dropdownHeight;
            if (previousVerticalPosition === 'below' &&
                !enoughRoomBelow &&
                enoughRoomAbove) {
                verticalPosition = 'above';
            }
            else if (previousVerticalPosition === 'above' &&
                !enoughRoomAbove &&
                enoughRoomBelow) {
                verticalPosition = 'below';
            }
            else if (!previousVerticalPosition) {
                verticalPosition = enoughRoomBelow ? 'below' : 'above';
            }
            else {
                verticalPosition = previousVerticalPosition;
            }
            style.top =
                triggerTopWithScroll +
                    (verticalPosition === 'below' ? triggerHeight : -dropdownHeight);
        }
        return { horizontalPosition: horizontalPosition, verticalPosition: verticalPosition, style: style };
    }
    /**
     * @param {?} trigger
     * @param {?} dropdown
     * @param {?} __2
     * @return {?}
     */
    function calculateInPlacePosition(trigger, dropdown, _a) {
        var horizontalPosition = _a.horizontalPosition, verticalPosition = _a.verticalPosition;
        /** @type {?} */
        var dropdownRect;
        /** @type {?} */
        var positionData = {};
        if (horizontalPosition === 'auto') {
            /** @type {?} */
            var triggerRect = trigger.getBoundingClientRect();
            dropdownRect = dropdown.getBoundingClientRect();
            /** @type {?} */
            var viewportRight = window.pageXOffset + window.innerWidth;
            positionData.horizontalPosition =
                triggerRect.left + dropdownRect.width > viewportRight ? 'right' : 'left';
        }
        if (verticalPosition === 'above') {
            positionData.verticalPosition = verticalPosition;
            dropdownRect = dropdownRect || dropdown.getBoundingClientRect();
            positionData.style = { top: -dropdownRect.height };
        }
        return positionData;
    }

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
     */
    /** @type {?} */
    var _id = 1;
    /**
     * @return {?}
     */
    function generateDropdownId() {
        return _id++;
    }
    /** @type {?} */
    var EmptyDropdownContentPosition = Object.freeze({
        vPosition: null,
        hPosition: null,
        top: null,
        left: null,
        bottom: null,
        right: null
    });
    var AngularDropdownDirective = /** @class */ (function () {
        function AngularDropdownDirective(document, id) {
            var _this = this;
            this.renderInPlace = false;
            this.control = null;
            this.previousVerticalPosition = null;
            this.previousHorizontalPosition = null;
            this.matchTriggerWidth = false;
            this._isOpen$ = new rxjs.BehaviorSubject(false);
            this.isOpen$ = this._isOpen$.pipe(operators.skip(1));
            this.position$ = new rxjs.BehaviorSubject(EmptyDropdownContentPosition);
            this.calculatePosition = calculatePosition;
            this.calculateInPlacePosition = calculateInPlacePosition;
            this.disabled = false;
            this.beforeOpen = null;
            this.beforeClose = null;
            this.verticalPosition = 'auto';
            this.horizontalPosition = 'auto';
            this.onOpen = this.isOpen$.pipe(operators.filter(function (open) { return open === true; }));
            this.onClose = this.isOpen$.pipe(operators.filter(function (open) { return open === false; }));
            this.uniqueId = null;
            this.width = null;
            this.reposition = function () {
                if (!_this._isOpen$.getValue()) {
                    return null;
                }
                /** @type {?} */
                var dropdownElement = _this.dropdownElement;
                if (!dropdownElement || !_this.triggerElement) {
                    return null;
                }
                /** @type {?} */
                var _calculatePosition = _this.renderInPlace
                    ? _this.calculateInPlacePosition
                    : _this.calculatePosition;
                /** @type {?} */
                var options = {
                    horizontalPosition: _this.horizontalPosition,
                    verticalPosition: _this.verticalPosition,
                    matchTriggerWidth: _this.matchTriggerWidth,
                    previousHorizontalPosition: _this.previousHorizontalPosition,
                    previousVerticalPosition: _this.previousVerticalPosition
                };
                /** @type {?} */
                var positionData = _calculatePosition(_this.triggerElement, dropdownElement, options);
                return _this.applyReposition(_this.triggerElement, dropdownElement, positionData);
            };
            this.document = document;
            this.initializeId(id);
            this.createDefaultWormholeOutlet();
        }
        Object.defineProperty(AngularDropdownDirective.prototype, "dropdownId", {
            get: /**
             * @return {?}
             */ function () {
                return "ng-dropdown-content-" + this.uniqueId;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(AngularDropdownDirective.prototype, "triggerElement", {
            get: /**
             * @return {?}
             */ function () {
                return this.control && this.control.element.nativeElement;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(AngularDropdownDirective.prototype, "dropdownElement", {
            get: /**
             * @return {?}
             */ function () {
                return this.document.getElementById(this.dropdownId);
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @param {?} __0
         * @return {?}
         */
        AngularDropdownDirective.prototype.ngOnChanges = /**
         * @param {?} __0
         * @return {?}
         */
            function (_a) {
                var disabled = _a.disabled;
                if (disabled &&
                    disabled.firstChange === false &&
                    disabled.currentValue === true &&
                    disabled.previousValue !== true) {
                    this.disable();
                }
            };
        /**
         * @return {?}
         */
        AngularDropdownDirective.prototype.open = /**
         * @return {?}
         */
            function () {
                var _this = this;
                if (this.disabled || this._isOpen$.getValue()) {
                    return;
                }
                /** @type {?} */
                var open$ = rxjs.of(true);
                if (this.beforeOpen) {
                    /** @type {?} */
                    var result = this.beforeOpen();
                    open$ = result instanceof rxjs.Observable ? result : rxjs.of(result);
                }
                open$
                    .pipe(operators.first(), operators.filter(function (open) { return open === true; }))
                    .subscribe(function () { return _this._isOpen$.next(true); });
            };
        /**
         * @param {?=} skipFocus
         * @return {?}
         */
        AngularDropdownDirective.prototype.close = /**
         * @param {?=} skipFocus
         * @return {?}
         */
            function (skipFocus) {
                var _this = this;
                if (skipFocus === void 0) {
                    skipFocus = false;
                }
                if (this.disabled || !this._isOpen$.getValue()) {
                    return;
                }
                /** @type {?} */
                var close$ = rxjs.of(true);
                if (this.beforeClose) {
                    /** @type {?} */
                    var result = this.beforeClose();
                    close$ = result instanceof rxjs.Observable ? result : rxjs.of(result);
                }
                close$
                    .pipe(operators.first(), operators.filter(function (close) { return close === true; }))
                    .subscribe(function () {
                    Object.assign(_this, {
                        hPosition: null,
                        vPosition: null,
                        top: null,
                        right: null,
                        bottom: null,
                        left: null,
                        width: null,
                        previousVerticalPosition: null,
                        previousHorizontalPosition: null
                    });
                    _this._isOpen$.next(false);
                    if (!skipFocus) {
                        if (_this.triggerElement instanceof HTMLElement &&
                            _this.triggerElement.tabIndex > -1) {
                            _this.triggerElement.focus();
                        }
                    }
                });
            };
        /**
         * @return {?}
         */
        AngularDropdownDirective.prototype.toggle = /**
         * @return {?}
         */
            function () {
                if (this._isOpen$.getValue()) {
                    this.close();
                }
                else {
                    this.open();
                }
            };
        /**
         * @return {?}
         */
        AngularDropdownDirective.prototype.disable = /**
         * @return {?}
         */
            function () {
                this.disabled = true;
                this.close();
            };
        /**
         * @return {?}
         */
        AngularDropdownDirective.prototype.enable = /**
         * @return {?}
         */
            function () {
                this.disabled = false;
            };
        /**
         * @param {?} trigger
         * @param {?} dropdown
         * @param {?} positions
         * @return {?}
         */
        AngularDropdownDirective.prototype.applyReposition = /**
         * @param {?} trigger
         * @param {?} dropdown
         * @param {?} positions
         * @return {?}
         */
            function (trigger, dropdown, positions) {
                /** @type {?} */
                var changes = {
                    hPosition: positions.horizontalPosition,
                    vPosition: positions.verticalPosition
                };
                if (positions.style) {
                    changes.top = positions.style.top + "px";
                    // The component can be aligned from the right or from the left, but not from both.
                    if (positions.style.left != null) {
                        changes.left = positions.style.left + "px";
                        changes.right = null;
                    }
                    else if (positions.style.right != null) {
                        changes.right = positions.style.right + "px";
                        changes.left = null;
                    }
                    if (positions.style.width != null) {
                        changes.width = positions.style.width + "px";
                    }
                    if (this.position$.getValue().top == null) {
                        // Bypass on the first reposition only to avoid flickering.
                        Object.keys(positions.style).forEach(function (k) { return (dropdown.style[( /** @type {?} */(k))] = positions.style[k]); });
                    }
                }
                this.position$.next(changes);
                this.previousHorizontalPosition = positions.horizontalPosition;
                this.previousVerticalPosition = positions.verticalPosition;
                return changes;
            };
        /**
         * @param {?=} id
         * @return {?}
         */
        AngularDropdownDirective.prototype.initializeId = /**
         * @param {?=} id
         * @return {?}
         */
            function (id) {
                if (id) {
                    this.id = this.uniqueId = id;
                }
                else {
                    this.uniqueId = generateDropdownId();
                    this.id = "ng-dropdown-" + this.uniqueId;
                }
            };
        /**
         * @return {?}
         */
        AngularDropdownDirective.prototype.createDefaultWormholeOutlet = /**
         * @return {?}
         */
            function () {
                if (!this.document.getElementById('ng-dropdown-outlet')) {
                    /** @type {?} */
                    var outlet = this.document.createElement('div');
                    outlet.id = 'ng-dropdown-outlet';
                    this.document.body.insertBefore(outlet, this.document.body.firstChild);
                }
            };
        AngularDropdownDirective.decorators = [
            { type: core.Directive, args: [{
                        selector: 'ng-dropdown,[ngDropdown],[ng-dropdown]',
                        host: {
                            '[class.render-in-place]': 'renderInPlace',
                            '[class.ng-dropdown]': 'true'
                        },
                        exportAs: 'ngDropdown'
                    },] }
        ];
        AngularDropdownDirective.ctorParameters = function () {
            return [
                { type: undefined, decorators: [{ type: core.Inject, args: [common.DOCUMENT,] }] },
                { type: String, decorators: [{ type: core.Attribute, args: ['id',] }] }
            ];
        };
        AngularDropdownDirective.propDecorators = {
            renderInPlace: [{ type: core.Input }],
            control: [{ type: core.ContentChild, args: [AngularDropdownControlDirective,] }],
            calculatePosition: [{ type: core.Input }],
            calculateInPlacePosition: [{ type: core.Input }],
            disabled: [{ type: core.Input }],
            beforeOpen: [{ type: core.Input }],
            beforeClose: [{ type: core.Input }],
            verticalPosition: [{ type: core.Input }],
            horizontalPosition: [{ type: core.Input }],
            onOpen: [{ type: core.Output, args: ['open',] }],
            onClose: [{ type: core.Output, args: ['close',] }],
            dropdownContent: [{ type: core.ContentChild, args: [core.forwardRef(function () { return AngularDropdownContentComponent; }),] }]
        };
        return AngularDropdownDirective;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
     */
    /** @type {?} */
    var MutationObserver = (( /** @type {?} */(window))).MutationObserver;
    var AngularDropdownContentComponent = /** @class */ (function () {
        function AngularDropdownContentComponent(dropdown, zone, document) {
            var _this = this;
            this.dropdown = dropdown;
            this.zone = zone;
            this.dropdownClass = '';
            this.overlay = false;
            this.hasMoved = false;
            this._animationClass = null;
            this.isTouchDevice = 'ontouchstart' in window;
            this.mutationObserver = null;
            this.destroy$ = new rxjs.Subject();
            this.transitioningInClass = 'ng-dropdown-content--transitioning-in';
            this.transitionedInClass = 'ng-dropdown-content--transitioned-in';
            this.transitioningOutClass = 'ng-dropdown-content--transitioning-out';
            this.shouldOpen = false;
            this.repositionInZone = function () {
                return _this.zone.run(function () { return _this.dropdown.reposition(); });
            };
            this.handleRootMouseDown = function (e) {
                var target = ( /** @type {?} */(e)).target;
                if (_this.hasMoved ||
                    (_this.dropdownElement !== null &&
                        _this.dropdownElement.contains(target)) ||
                    (_this.triggerElement !== null && _this.triggerElement.contains(target))) {
                    _this.hasMoved = false;
                    return;
                }
                /** @type {?} */
                var closestDropdown = closest(target, 'ng-dropdown-content');
                if (closestDropdown !== null) {
                    /** @type {?} */
                    var trigger = _this.document.querySelector("[aria-controls=" + closestDropdown.getAttribute('id') + "]");
                    /** @type {?} */
                    var parentDropdown = closest(( /** @type {?} */(trigger)), 'ng-dropdown-content');
                    if (parentDropdown !== null &&
                        parentDropdown.getAttribute('id') === _this.dropdown.dropdownId) {
                        _this.hasMoved = false;
                        return;
                    }
                }
                _this.dropdown.close(true);
            };
            this.touchStartHandler = function (e) {
                _this.document.body.addEventListener('touchmove', _this.touchMoveHandler, true);
            };
            this.touchMoveHandler = function (e) {
                _this.hasMoved = true;
                _this.document.body.removeEventListener('touchmove', _this.touchMoveHandler, true);
            };
            this.document = document;
        }
        Object.defineProperty(AngularDropdownContentComponent.prototype, "dropdownElement", {
            get: /**
             * @return {?}
             */ function () {
                return this.dropdown.dropdownElement;
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @return {?}
         */
        AngularDropdownContentComponent.prototype.ngOnInit = /**
         * @return {?}
         */
            function () {
                var _this = this;
                this.dropdown.onOpen
                    .pipe(operators.takeUntil(this.destroy$))
                    .subscribe(function () { return (_this.shouldOpen = true); });
                this.dropdown.onClose
                    .pipe(operators.takeUntil(this.destroy$))
                    .subscribe(function () { return _this.close(); });
            };
        Object.defineProperty(AngularDropdownContentComponent.prototype, "animationClass", {
            get: /**
             * @return {?}
             */ function () {
                return this._animationClass;
            },
            set: /**
             * @param {?} className
             * @return {?}
             */ function (className) {
                if (this.dropdownElement !== null) {
                    if (this._animationClass && className !== this._animationClass) {
                        this.dropdownElement.classList.remove(this._animationClass);
                    }
                    else if (className) {
                        this.dropdownElement.classList.add(className);
                    }
                }
                this._animationClass = className;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(AngularDropdownContentComponent.prototype, "triggerElement", {
            get: /**
             * @return {?}
             */ function () {
                return this.dropdown.triggerElement;
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @return {?}
         */
        AngularDropdownContentComponent.prototype.ngAfterViewChecked = /**
         * @return {?}
         */
            function () {
                var _this = this;
                if (this.shouldOpen) {
                    this.animationClass = this.transitioningInClass;
                    requestAnimationFrame(function () { return _this.open(); });
                    this.shouldOpen = false;
                }
            };
        /**
         * @return {?}
         */
        AngularDropdownContentComponent.prototype.ngOnDestroy = /**
         * @return {?}
         */
            function () {
                this.destroy$.next();
                this.teardownEvents();
            };
        /**
         * @return {?}
         */
        AngularDropdownContentComponent.prototype.open = /**
         * @return {?}
         */
            function () {
                var _this = this;
                this.document.body.addEventListener('mousedown', this.handleRootMouseDown, true);
                if (this.isTouchDevice) {
                    this.document.body.addEventListener('touchstart', this.touchStartHandler, true);
                    this.document.body.addEventListener('touchend', this.handleRootMouseDown, true);
                }
                /** @type {?} */
                var changes = this.dropdown.reposition();
                if (!this.dropdown.renderInPlace) {
                    this.addGlobalEvents();
                    this.startObservingDomMutations();
                }
                else if (changes !== null && changes.vPosition === 'above') {
                    this.startObservingDomMutations();
                }
                requestAnimationFrame(function () { return _this.animateIn(); });
            };
        /**
         * @return {?}
         */
        AngularDropdownContentComponent.prototype.close = /**
         * @return {?}
         */
            function () {
                this.teardownEvents();
                this.animateOut();
            };
        /**
         * @return {?}
         */
        AngularDropdownContentComponent.prototype.animateIn = /**
         * @return {?}
         */
            function () {
                var _this = this;
                waitForAnimation(this.dropdownElement, function () {
                    _this.animationClass = _this.transitionedInClass;
                });
            };
        /**
         * @return {?}
         */
        AngularDropdownContentComponent.prototype.animateOut = /**
         * @return {?}
         */
            function () {
                if (this.dropdownElement === null) {
                    return;
                }
                /** @type {?} */
                var parentElement = this.dropdown.renderInPlace
                    ? ( /** @type {?} */(( /** @type {?} */(this.dropdownElement.parentElement)).parentElement))
                    : ( /** @type {?} */(this.dropdownElement.parentElement));
                /** @type {?} */
                var clone = ( /** @type {?} */(this.dropdownElement.cloneNode(true)));
                clone.id = this.dropdownElement.id + "--clone";
                clone.classList.remove(this.transitionedInClass);
                clone.classList.remove(this.transitioningInClass);
                clone.classList.add(this.transitioningOutClass);
                parentElement.appendChild(clone);
                this.animationClass = this.transitioningInClass;
                waitForAnimation(clone, function () { return parentElement.removeChild(clone); });
            };
        /**
         * @return {?}
         */
        AngularDropdownContentComponent.prototype.startObservingDomMutations = /**
         * @return {?}
         */
            function () {
                var _this = this;
                if (MutationObserver !== undefined) {
                    this.mutationObserver = new MutationObserver(function (mutations) {
                        if (mutations[0].addedNodes.length ||
                            mutations[0].removedNodes.length) {
                            _this.repositionInZone();
                        }
                    });
                    ( /** @type {?} */(this.mutationObserver)).observe(( /** @type {?} */(this.dropdownElement)), {
                        childList: true,
                        subtree: true
                    });
                }
                else {
                    ( /** @type {?} */(this.dropdownElement)).addEventListener('DOMNodeInserted', this.repositionInZone, false);
                    ( /** @type {?} */(this.dropdownElement)).addEventListener('DOMNodeRemoved', this.repositionInZone, false);
                }
            };
        /**
         * @return {?}
         */
        AngularDropdownContentComponent.prototype.stopObservingDomMutations = /**
         * @return {?}
         */
            function () {
                if (MutationObserver) {
                    if (this.mutationObserver) {
                        this.mutationObserver.disconnect();
                        this.mutationObserver = null;
                    }
                }
                else {
                    if (this.dropdownElement !== null) {
                        this.dropdownElement.removeEventListener('DOMNodeInserted', this.repositionInZone);
                        this.dropdownElement.removeEventListener('DOMNodeRemoved', this.repositionInZone);
                    }
                }
            };
        /**
         * @return {?}
         */
        AngularDropdownContentComponent.prototype.addGlobalEvents = /**
         * @return {?}
         */
            function () {
                window.addEventListener('scroll', this.repositionInZone);
                window.addEventListener('resize', this.repositionInZone);
                window.addEventListener('orientationchange', this.repositionInZone);
            };
        /**
         * @return {?}
         */
        AngularDropdownContentComponent.prototype.removeGlobalEvents = /**
         * @return {?}
         */
            function () {
                window.removeEventListener('scroll', this.repositionInZone);
                window.removeEventListener('resize', this.repositionInZone);
                window.removeEventListener('orientationchange', this.repositionInZone);
            };
        /**
         * @return {?}
         */
        AngularDropdownContentComponent.prototype.teardownEvents = /**
         * @return {?}
         */
            function () {
                this.removeGlobalEvents();
                this.stopObservingDomMutations();
                this.document.body.removeEventListener('mousedown', this.handleRootMouseDown, true);
                if (this.isTouchDevice) {
                    this.document.body.removeEventListener('touchstart', this.touchStartHandler, true);
                    this.document.body.removeEventListener('touchend', this.handleRootMouseDown, true);
                }
            };
        AngularDropdownContentComponent.decorators = [
            { type: core.Component, args: [{
                        selector: 'ng-dropdown-content,[ng-dropdown-content],[ngDropdownContent]',
                        template: "<ng-container *ngIf=\"dropdown.isOpen$ | async as isOpen\">\n  <ng-container *ngWormhole=\"'#ng-dropdown-outlet'; renderInPlace: dropdown.renderInPlace\">\n    <div *ngIf=\"overlay && isOpen\" class=\"ng-dropdown-overlay\"></div>\n    <div [id]=\"dropdown.dropdownId\"\n        class=\"ng-dropdown-content {{dropdownClass}}\"\n        [style.top]=\"(dropdown.position$ | async)?.top\"\n        [style.right]=\"(dropdown.position$ | async)?.right\"\n        [style.bottom]=\"(dropdown.position$ | async)?.bottom\"\n        [style.left]=\"(dropdown.position$ | async)?.left\"\n        [class.render-in-place]=\"dropdown.renderInPlace\"\n        [class.ng-dropdown-content--above]=\"(dropdown.position$ | async)?.vPosition === 'above'\"\n        [class.ng-dropdown-content--below]=\"(dropdown.position$ | async)?.vPosition === 'below'\"\n        [class.ng-dropdown-content--right]=\"(dropdown.position$ | async)?.hPosition === 'right'\"\n        [class.ng-dropdown-content--center]=\"(dropdown.position$ | async)?.hPosition === 'center'\"\n        [class.ng-dropdown-content--left]=\"(dropdown.position$ | async)?.hPosition === 'left'\">\n      <ng-content></ng-content>\n    </div>\n  </ng-container>\n  <div *ngIf=\"!isOpen\" [id]=\"dropdown.dropdownId\" class=\"ng-dropdown-placeholder\"></div>\n</ng-container>\n",
                        host: {
                            '[class.render-in-place]': 'dropdown.renderInPlace'
                        },
                        styles: [":host{display:none}:host.render-in-place{display:block;position:absolute}"]
                    }] }
        ];
        AngularDropdownContentComponent.ctorParameters = function () {
            return [
                { type: AngularDropdownDirective, decorators: [{ type: core.Host }, { type: core.Inject, args: [core.forwardRef(function () { return AngularDropdownDirective; }),] }] },
                { type: core.NgZone },
                { type: undefined, decorators: [{ type: core.Inject, args: [common.DOCUMENT,] }] }
            ];
        };
        AngularDropdownContentComponent.propDecorators = {
            dropdownClass: [{ type: core.Input }],
            overlay: [{ type: core.Input }],
            transitioningInClass: [{ type: core.Input }],
            transitionedInClass: [{ type: core.Input }],
            transitioningOutClass: [{ type: core.Input }]
        };
        return AngularDropdownContentComponent;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
     */
    var AngularDropdownModule = /** @class */ (function () {
        function AngularDropdownModule() {
        }
        AngularDropdownModule.decorators = [
            { type: core.NgModule, args: [{
                        imports: [common.CommonModule, ngWormhole.NgWormholeModule],
                        declarations: [
                            AngularDropdownDirective,
                            AngularDropdownControlDirective,
                            AngularDropdownContentComponent
                        ],
                        exports: [
                            AngularDropdownDirective,
                            AngularDropdownControlDirective,
                            AngularDropdownContentComponent
                        ]
                    },] }
        ];
        return AngularDropdownModule;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
     */

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
     */

    exports.AngularDropdownContentComponent = AngularDropdownContentComponent;
    exports.AngularDropdownControlDirective = AngularDropdownControlDirective;
    exports.AngularDropdownDirective = AngularDropdownDirective;
    exports.AngularDropdownModule = AngularDropdownModule;

    Object.defineProperty(exports, '__esModule', { value: true });

})));

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYW5ndWxhci1kcm9wZG93bi51bWQuanMubWFwIiwic291cmNlcyI6WyJuZzovL2FuZ3VsYXItZHJvcGRvd24vbGliL2FuZ3VsYXItZHJvcGRvd24tY29udHJvbC5kaXJlY3RpdmUudHMiLCJuZzovL2FuZ3VsYXItZHJvcGRvd24vbGliL3V0aWxzLnRzIiwibmc6Ly9hbmd1bGFyLWRyb3Bkb3duL2xpYi9hbmd1bGFyLWRyb3Bkb3duLmRpcmVjdGl2ZS50cyIsIm5nOi8vYW5ndWxhci1kcm9wZG93bi9saWIvYW5ndWxhci1kcm9wZG93bi1jb250ZW50LmNvbXBvbmVudC50cyIsIm5nOi8vYW5ndWxhci1kcm9wZG93bi9saWIvYW5ndWxhci1kcm9wZG93bi5tb2R1bGUudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgRGlyZWN0aXZlLFxuICBFbGVtZW50UmVmLFxuICBJbmplY3QsXG4gIGZvcndhcmRSZWYsXG4gIElucHV0LFxuICBIb3N0LFxuICBIb3N0TGlzdGVuZXJcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5cbmltcG9ydCB7IEFuZ3VsYXJEcm9wZG93bkRpcmVjdGl2ZSB9XG4gIGZyb20gJy4vYW5ndWxhci1kcm9wZG93bi5kaXJlY3RpdmUnO1xuaW1wb3J0IHsgU3Vic2NyaXB0aW9uIH0gZnJvbSAncnhqcyc7XG5cbkBEaXJlY3RpdmUoe1xuICBzZWxlY3RvcjogJ1tuZy1kcm9wZG93bi1jb250cm9sXSxbbmdEcm9wZG93bkNvbnRyb2xdJyxcbiAgaG9zdDoge1xuICAgICdbYXR0ci5hcmlhLWhhc3BvcHVwXSc6ICd0cnVlJyxcbiAgICAnW2F0dHIuYXJpYS1jb250cm9sc10nOiAnZHJvcGRvd24uaWQnLFxuICAgICdbYXR0ci5hcmlhLWV4cGFuZGVkXSc6ICdpc0Ryb3Bkb3duT3BlbicsXG4gICAgJ1tjbGFzcy5uZy1kcm9wZG93bi1jb250cm9sXSc6ICd0cnVlJyxcbiAgICAnW2NsYXNzLmFjdGl2ZV0nOiAnaXNEcm9wZG93bk9wZW4nXG4gIH1cbn0pXG5leHBvcnQgY2xhc3MgQW5ndWxhckRyb3Bkb3duQ29udHJvbERpcmVjdGl2ZSB7XG4gIGlzRHJvcGRvd25PcGVuOiBib29sZWFuID0gZmFsc2U7XG4gIGRyb3Bkb3duU3RhdGVTdWJzY3JpcHRpb24/OiBTdWJzY3JpcHRpb247XG5cbiAgQEhvc3RMaXN0ZW5lcignY2xpY2snLCBbICckZXZlbnQnIF0pXG4gIG9uQ2xpY2soZTogRXZlbnQpOiB2b2lkIHtcbiAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuXG4gICAgaWYgKCF0aGlzLmRyb3Bkb3duLmRpc2FibGVkKSB7XG4gICAgICB0aGlzLmRyb3Bkb3duLnRvZ2dsZSgpO1xuICAgIH1cbiAgfVxuXG4gIGNvbnN0cnVjdG9yKFxuICAgICAgQEhvc3QoKVxuICAgICAgQEluamVjdChmb3J3YXJkUmVmKCgpID0+IEFuZ3VsYXJEcm9wZG93bkRpcmVjdGl2ZSkpXG4gICAgICBwdWJsaWMgZHJvcGRvd246IEFuZ3VsYXJEcm9wZG93bkRpcmVjdGl2ZSxcbiAgICAgIHB1YmxpYyBlbGVtZW50OiBFbGVtZW50UmVmKSB7XG4gIH1cblxuICBuZ09uSW5pdCgpIHtcbiAgICB0aGlzLmRyb3Bkb3duU3RhdGVTdWJzY3JpcHRpb24gPSB0aGlzLmRyb3Bkb3duLmlzT3BlbiQuc3Vic2NyaWJlKFxuICAgICAgaXNPcGVuID0+ICh0aGlzLmlzRHJvcGRvd25PcGVuID0gaXNPcGVuKVxuICAgICk7XG4gIH1cblxuICBuZ09uRGVzdHJveSgpe1xuICAgIHRoaXMuZHJvcGRvd25TdGF0ZVN1YnNjcmlwdGlvbiAmJiB0aGlzLmRyb3Bkb3duU3RhdGVTdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcbiAgfVxufVxuIiwiZXhwb3J0IGZ1bmN0aW9uIHdhaXRGb3JBbmltYXRpb24oXG4gIGVsZW1lbnQ6IEVsZW1lbnQgfCBudWxsLFxuICBjYWxsYmFjazogKGU/OiBFdmVudCkgPT4gYW55XG4pOiB2b2lkIHtcbiAgaWYgKGVsZW1lbnQgPT09IG51bGwpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4ge1xuICAgIGNvbnN0IGNvbXB1dGVkU3R5bGUgPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShlbGVtZW50KTtcblxuICAgIGlmIChcbiAgICAgIGNvbXB1dGVkU3R5bGUuYW5pbWF0aW9uTmFtZSAhPT0gJ25vbmUnICYmXG4gICAgICBjb21wdXRlZFN0eWxlLmFuaW1hdGlvblBsYXlTdGF0ZSA9PT0gJ3J1bm5pbmcnXG4gICAgKSB7XG4gICAgICByZXR1cm4gb25jZShlbGVtZW50LCAnYW5pbWF0aW9uZW5kJywgY2FsbGJhY2spO1xuICAgIH1cblxuICAgIGNhbGxiYWNrKCk7XG4gIH0pO1xufVxuXG5mdW5jdGlvbiBvbmNlKFxuICBlbGVtZW50OiBOb2RlLFxuICBldmVudE5hbWU6IHN0cmluZyxcbiAgbGlzdGVuZXI6IChlOiBFdmVudCkgPT4gYW55XG4pOiB2b2lkIHtcbiAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKGV2ZW50TmFtZSwgZnVuY3Rpb24gbGlzdGVuT25jZShlKSB7XG4gICAgZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKGV2ZW50TmFtZSwgbGlzdGVuT25jZSk7XG5cbiAgICByZXR1cm4gbGlzdGVuZXIoZSk7XG4gIH0pO1xufVxuXG5leHBvcnQgY29uc3QgY2xvc2VzdDogKGVsZW1lbnQ6IEVsZW1lbnQsIHNlbGVjdG9yOiBzdHJpbmcpID0+IEVsZW1lbnQgfCBudWxsID1cbiAgdHlwZW9mIEVsZW1lbnQgIT0gJ3VuZGVmaW5lZCcgJiYgRWxlbWVudC5wcm90b3R5cGUuY2xvc2VzdFxuICAgID8gKGVsLCBzKSA9PiBlbC5jbG9zZXN0KHMpXG4gICAgOiBmdW5jdGlvbiBfY2xvc2VzdChzZWxmOiBFbGVtZW50LCBzOiBzdHJpbmcpIHtcbiAgICAgICAgY29uc3QgbWF0Y2hlcyA9IChcbiAgICAgICAgICAoc2VsZiBhcyBhbnkpLmRvY3VtZW50IHx8IHNlbGYub3duZXJEb2N1bWVudFxuICAgICAgICApLnF1ZXJ5U2VsZWN0b3JBbGwocyk7XG4gICAgICAgIGxldCBpO1xuICAgICAgICBsZXQgZWw6IEVsZW1lbnQgfCBudWxsID0gc2VsZjtcbiAgICAgICAgZG8ge1xuICAgICAgICAgIGkgPSBtYXRjaGVzLmxlbmd0aDtcbiAgICAgICAgICB3aGlsZSAoLS1pID49IDAgJiYgbWF0Y2hlcy5pdGVtKGkpICE9PSBlbCkge31cbiAgICAgICAgfSB3aGlsZSAoaSA8IDAgJiYgKGVsID0gZWwucGFyZW50RWxlbWVudCkpO1xuICAgICAgICByZXR1cm4gZWw7XG4gICAgICB9O1xuXG5leHBvcnQgZnVuY3Rpb24gY2FsY3VsYXRlUG9zaXRpb24oXG4gIHRyaWdnZXI6IEVsZW1lbnQsXG4gIGRyb3Bkb3duOiBFbGVtZW50LFxuICB7XG4gICAgaG9yaXpvbnRhbFBvc2l0aW9uLFxuICAgIHZlcnRpY2FsUG9zaXRpb24sXG4gICAgbWF0Y2hUcmlnZ2VyV2lkdGgsXG4gICAgcHJldmlvdXNIb3Jpem9udGFsUG9zaXRpb24sXG4gICAgcHJldmlvdXNWZXJ0aWNhbFBvc2l0aW9uXG4gIH06IGFueVxuKTogYW55IHtcbiAgLy8gQ29sbGVjdCBpbmZvcm1hdGlvbiBhYm91dCBhbGwgdGhlIGludm9sdmVkIERPTSBlbGVtZW50c1xuICBjb25zdCBzY3JvbGwgPSB7IGxlZnQ6IHdpbmRvdy5wYWdlWE9mZnNldCwgdG9wOiB3aW5kb3cucGFnZVlPZmZzZXQgfTtcbiAgY29uc3Qge1xuICAgIGxlZnQ6IHRyaWdnZXJMZWZ0LFxuICAgIHRvcDogdHJpZ2dlclRvcCxcbiAgICB3aWR0aDogdHJpZ2dlcldpZHRoLFxuICAgIGhlaWdodDogdHJpZ2dlckhlaWdodFxuICB9ID0gdHJpZ2dlci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgbGV0IHtcbiAgICBoZWlnaHQ6IGRyb3Bkb3duSGVpZ2h0LFxuICAgIHdpZHRoOiBkcm9wZG93bldpZHRoXG4gIH0gPSBkcm9wZG93bi5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgY29uc3Qgdmlld3BvcnRXaWR0aCA9IHdpbmRvdy5pbm5lcldpZHRoO1xuICBjb25zdCBzdHlsZTogYW55ID0ge307XG5cbiAgLy8gQ2FsY3VsYXRlIGRyb3AgZG93biB3aWR0aFxuICBkcm9wZG93bldpZHRoID0gbWF0Y2hUcmlnZ2VyV2lkdGggPyB0cmlnZ2VyV2lkdGggOiBkcm9wZG93bldpZHRoO1xuICBpZiAobWF0Y2hUcmlnZ2VyV2lkdGgpIHtcbiAgICBzdHlsZS53aWR0aCA9IGRyb3Bkb3duV2lkdGg7XG4gIH1cblxuICAvLyBDYWxjdWxhdGUgaG9yaXpvbnRhbCBwb3NpdGlvblxuICBjb25zdCB0cmlnZ2VyTGVmdFdpdGhTY3JvbGwgPSB0cmlnZ2VyTGVmdCArIHNjcm9sbC5sZWZ0O1xuICBpZiAoaG9yaXpvbnRhbFBvc2l0aW9uID09PSAnYXV0bycpIHtcbiAgICAvLyBDYWxjdWxhdGUgdGhlIG51bWJlciBvZiB2aXNpYmxlIGhvcml6b250YWwgcGl4ZWxzIGlmIHdlIHdlcmUgdG8gcGxhY2UgdGhlXG4gICAgLy8gZHJvcGRvd24gb24gdGhlIGxlZnQgYW5kIHJpZ2h0XG4gICAgY29uc3QgbGVmdFZpc2libGUgPVxuICAgICAgTWF0aC5taW4odmlld3BvcnRXaWR0aCwgdHJpZ2dlckxlZnQgKyBkcm9wZG93bldpZHRoKSAtXG4gICAgICBNYXRoLm1heCgwLCB0cmlnZ2VyTGVmdCk7XG4gICAgY29uc3QgcmlnaHRWaXNpYmxlID1cbiAgICAgIE1hdGgubWluKHZpZXdwb3J0V2lkdGgsIHRyaWdnZXJMZWZ0ICsgdHJpZ2dlcldpZHRoKSAtXG4gICAgICBNYXRoLm1heCgwLCB0cmlnZ2VyTGVmdCArIHRyaWdnZXJXaWR0aCAtIGRyb3Bkb3duV2lkdGgpO1xuXG4gICAgaWYgKGRyb3Bkb3duV2lkdGggPiBsZWZ0VmlzaWJsZSAmJiByaWdodFZpc2libGUgPiBsZWZ0VmlzaWJsZSkge1xuICAgICAgLy8gSWYgdGhlIGRyb3AgZG93biB3b24ndCBmaXQgbGVmdC1hbGlnbmVkLCBhbmQgdGhlcmUgaXMgbW9yZSBzcGFjZSBvbiB0aGVcbiAgICAgIC8vIHJpZ2h0IHRoYW4gb24gdGhlIGxlZnQsIHRoZW4gZm9yY2UgcmlnaHQtYWxpZ25lZFxuICAgICAgaG9yaXpvbnRhbFBvc2l0aW9uID0gJ3JpZ2h0JztcbiAgICB9IGVsc2UgaWYgKGRyb3Bkb3duV2lkdGggPiByaWdodFZpc2libGUgJiYgbGVmdFZpc2libGUgPiByaWdodFZpc2libGUpIHtcbiAgICAgIC8vIElmIHRoZSBkcm9wIGRvd24gd29uJ3QgZml0IHJpZ2h0LWFsaWduZWQsIGFuZCB0aGVyZSBpcyBtb3JlIHNwYWNlIG9uXG4gICAgICAvLyB0aGUgbGVmdCB0aGFuIG9uIHRoZSByaWdodCwgdGhlbiBmb3JjZSBsZWZ0LWFsaWduZWRcbiAgICAgIGhvcml6b250YWxQb3NpdGlvbiA9ICdsZWZ0JztcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gS2VlcCBzYW1lIHBvc2l0aW9uIGFzIHByZXZpb3VzXG4gICAgICBob3Jpem9udGFsUG9zaXRpb24gPSBwcmV2aW91c0hvcml6b250YWxQb3NpdGlvbiB8fCAnbGVmdCc7XG4gICAgfVxuICB9XG4gIGlmIChob3Jpem9udGFsUG9zaXRpb24gPT09ICdyaWdodCcpIHtcbiAgICBzdHlsZS5yaWdodCA9IHZpZXdwb3J0V2lkdGggLSAodHJpZ2dlckxlZnRXaXRoU2Nyb2xsICsgdHJpZ2dlcldpZHRoKTtcbiAgfSBlbHNlIGlmIChob3Jpem9udGFsUG9zaXRpb24gPT09ICdjZW50ZXInKSB7XG4gICAgc3R5bGUubGVmdCA9IHRyaWdnZXJMZWZ0V2l0aFNjcm9sbCArICh0cmlnZ2VyV2lkdGggLSBkcm9wZG93bldpZHRoKSAvIDI7XG4gIH0gZWxzZSB7XG4gICAgc3R5bGUubGVmdCA9IHRyaWdnZXJMZWZ0V2l0aFNjcm9sbDtcbiAgfVxuXG4gIC8vIENhbGN1bGF0ZSB2ZXJ0aWNhbCBwb3NpdGlvblxuICBjb25zdCB0cmlnZ2VyVG9wV2l0aFNjcm9sbCA9IHRyaWdnZXJUb3AgKyBzY3JvbGwudG9wO1xuICBpZiAodmVydGljYWxQb3NpdGlvbiA9PT0gJ2Fib3ZlJykge1xuICAgIHN0eWxlLnRvcCA9IHRyaWdnZXJUb3BXaXRoU2Nyb2xsIC0gZHJvcGRvd25IZWlnaHQ7XG4gIH0gZWxzZSBpZiAodmVydGljYWxQb3NpdGlvbiA9PT0gJ2JlbG93Jykge1xuICAgIHN0eWxlLnRvcCA9IHRyaWdnZXJUb3BXaXRoU2Nyb2xsICsgdHJpZ2dlckhlaWdodDtcbiAgfSBlbHNlIHtcbiAgICBjb25zdCB2aWV3cG9ydEJvdHRvbSA9IHNjcm9sbC50b3AgKyBzZWxmLndpbmRvdy5pbm5lckhlaWdodDtcbiAgICBjb25zdCBlbm91Z2hSb29tQmVsb3cgPVxuICAgICAgdHJpZ2dlclRvcFdpdGhTY3JvbGwgKyB0cmlnZ2VySGVpZ2h0ICsgZHJvcGRvd25IZWlnaHQgPCB2aWV3cG9ydEJvdHRvbTtcbiAgICBjb25zdCBlbm91Z2hSb29tQWJvdmUgPSB0cmlnZ2VyVG9wID4gZHJvcGRvd25IZWlnaHQ7XG5cbiAgICBpZiAoXG4gICAgICBwcmV2aW91c1ZlcnRpY2FsUG9zaXRpb24gPT09ICdiZWxvdycgJiZcbiAgICAgICFlbm91Z2hSb29tQmVsb3cgJiZcbiAgICAgIGVub3VnaFJvb21BYm92ZVxuICAgICkge1xuICAgICAgdmVydGljYWxQb3NpdGlvbiA9ICdhYm92ZSc7XG4gICAgfSBlbHNlIGlmIChcbiAgICAgIHByZXZpb3VzVmVydGljYWxQb3NpdGlvbiA9PT0gJ2Fib3ZlJyAmJlxuICAgICAgIWVub3VnaFJvb21BYm92ZSAmJlxuICAgICAgZW5vdWdoUm9vbUJlbG93XG4gICAgKSB7XG4gICAgICB2ZXJ0aWNhbFBvc2l0aW9uID0gJ2JlbG93JztcbiAgICB9IGVsc2UgaWYgKCFwcmV2aW91c1ZlcnRpY2FsUG9zaXRpb24pIHtcbiAgICAgIHZlcnRpY2FsUG9zaXRpb24gPSBlbm91Z2hSb29tQmVsb3cgPyAnYmVsb3cnIDogJ2Fib3ZlJztcbiAgICB9IGVsc2Uge1xuICAgICAgdmVydGljYWxQb3NpdGlvbiA9IHByZXZpb3VzVmVydGljYWxQb3NpdGlvbjtcbiAgICB9XG4gICAgc3R5bGUudG9wID1cbiAgICAgIHRyaWdnZXJUb3BXaXRoU2Nyb2xsICtcbiAgICAgICh2ZXJ0aWNhbFBvc2l0aW9uID09PSAnYmVsb3cnID8gdHJpZ2dlckhlaWdodCA6IC1kcm9wZG93bkhlaWdodCk7XG4gIH1cblxuICByZXR1cm4geyBob3Jpem9udGFsUG9zaXRpb24sIHZlcnRpY2FsUG9zaXRpb24sIHN0eWxlIH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjYWxjdWxhdGVJblBsYWNlUG9zaXRpb24oXG4gIHRyaWdnZXI6IEVsZW1lbnQsXG4gIGRyb3Bkb3duOiBFbGVtZW50LFxuICB7IGhvcml6b250YWxQb3NpdGlvbiwgdmVydGljYWxQb3NpdGlvbiB9OiBhbnlcbikge1xuICBsZXQgZHJvcGRvd25SZWN0O1xuICBjb25zdCBwb3NpdGlvbkRhdGE6IGFueSA9IHt9O1xuXG4gIGlmIChob3Jpem9udGFsUG9zaXRpb24gPT09ICdhdXRvJykge1xuICAgIGNvbnN0IHRyaWdnZXJSZWN0ID0gdHJpZ2dlci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICBkcm9wZG93blJlY3QgPSBkcm9wZG93bi5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICBjb25zdCB2aWV3cG9ydFJpZ2h0ID0gd2luZG93LnBhZ2VYT2Zmc2V0ICsgd2luZG93LmlubmVyV2lkdGg7XG4gICAgcG9zaXRpb25EYXRhLmhvcml6b250YWxQb3NpdGlvbiA9XG4gICAgICB0cmlnZ2VyUmVjdC5sZWZ0ICsgZHJvcGRvd25SZWN0LndpZHRoID4gdmlld3BvcnRSaWdodCA/ICdyaWdodCcgOiAnbGVmdCc7XG4gIH1cbiAgaWYgKHZlcnRpY2FsUG9zaXRpb24gPT09ICdhYm92ZScpIHtcbiAgICBwb3NpdGlvbkRhdGEudmVydGljYWxQb3NpdGlvbiA9IHZlcnRpY2FsUG9zaXRpb247XG4gICAgZHJvcGRvd25SZWN0ID0gZHJvcGRvd25SZWN0IHx8IGRyb3Bkb3duLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgIHBvc2l0aW9uRGF0YS5zdHlsZSA9IHsgdG9wOiAtZHJvcGRvd25SZWN0LmhlaWdodCB9O1xuICB9XG4gIHJldHVybiBwb3NpdGlvbkRhdGE7XG59XG4iLCJpbXBvcnQgeyBPYnNlcnZhYmxlLCBCZWhhdmlvclN1YmplY3QsIG9mIH0gZnJvbSAncnhqcyc7XG5pbXBvcnQgeyBza2lwLCBmaXJzdCwgZmlsdGVyIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xuXG5pbXBvcnQge1xuICBDb21wb25lbnQsXG4gIERpcmVjdGl2ZSxcbiAgQXR0cmlidXRlLFxuICBJbmplY3QsXG4gIElucHV0LFxuICBPdXRwdXQsXG4gIEVsZW1lbnRSZWYsXG4gIEFmdGVyVmlld0luaXQsXG4gIE9uQ2hhbmdlcyxcbiAgQ29udGVudENoaWxkLFxuICBTaW1wbGVDaGFuZ2VzLFxuICBFdmVudEVtaXR0ZXIsXG4gIFF1ZXJ5TGlzdCxcbiAgVmlld0NvbnRhaW5lclJlZixcbiAgZm9yd2FyZFJlZlxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcblxuaW1wb3J0IHsgRE9DVU1FTlQgfSBmcm9tICdAYW5ndWxhci9jb21tb24nO1xuXG5pbXBvcnQgeyBBbmd1bGFyRHJvcGRvd25Db250cm9sRGlyZWN0aXZlIH0gZnJvbSAnLi9hbmd1bGFyLWRyb3Bkb3duLWNvbnRyb2wuZGlyZWN0aXZlJztcbmltcG9ydCB7IEFuZ3VsYXJEcm9wZG93bkNvbnRlbnRDb21wb25lbnQgfSBmcm9tICcuL2FuZ3VsYXItZHJvcGRvd24tY29udGVudC5jb21wb25lbnQnO1xuXG5pbXBvcnQgeyBjYWxjdWxhdGVQb3NpdGlvbiwgY2FsY3VsYXRlSW5QbGFjZVBvc2l0aW9uIH0gZnJvbSAnLi91dGlscyc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgQW5ndWxhckRyb3Bkb3duUG9zaXRpb25DaGFuZ2VzIHtcbiAgdlBvc2l0aW9uOiAnYWJvdmUnIHwgJ2JlbG93JztcbiAgaFBvc2l0aW9uOiAncmlnaHQnIHwgJ2NlbnRlcicgfCAnbGVmdCc7XG59XG5cbmxldCBfaWQgPSAxO1xuZnVuY3Rpb24gZ2VuZXJhdGVEcm9wZG93bklkKCkge1xuICByZXR1cm4gX2lkKys7XG59XG5cbmV4cG9ydCB0eXBlIFZlcnRpY2FsUG9zaXRpb24gPSAnYXV0bycgfCAnYWJvdmUnIHwgJ2JlbG93JztcbmV4cG9ydCB0eXBlIEhvcml6b250YWxQb3NpdGlvbiA9ICdhdXRvJyB8ICdyaWdodCcgfCAnY2VudGVyJyB8ICdsZWZ0JztcblxuZXhwb3J0IGludGVyZmFjZSBEcm9wZG93bkNvbnRlbnRQb3NpdGlvbiB7XG4gIHJlYWRvbmx5IGhQb3NpdGlvbjogSG9yaXpvbnRhbFBvc2l0aW9uIHwgbnVsbDtcbiAgcmVhZG9ubHkgdlBvc2l0aW9uOiBWZXJ0aWNhbFBvc2l0aW9uIHwgbnVsbDtcbiAgcmVhZG9ubHkgdG9wOiBzdHJpbmcgfCBudWxsO1xuICByZWFkb25seSBsZWZ0OiBzdHJpbmcgfCBudWxsO1xuICByZWFkb25seSBib3R0b206IHN0cmluZyB8IG51bGw7XG4gIHJlYWRvbmx5IHJpZ2h0OiBzdHJpbmcgfCBudWxsO1xufVxuXG5jb25zdCBFbXB0eURyb3Bkb3duQ29udGVudFBvc2l0aW9uID0gT2JqZWN0LmZyZWV6ZSh7XG4gIHZQb3NpdGlvbjogbnVsbCxcbiAgaFBvc2l0aW9uOiBudWxsLFxuICB0b3A6IG51bGwsXG4gIGxlZnQ6IG51bGwsXG4gIGJvdHRvbTogbnVsbCxcbiAgcmlnaHQ6IG51bGxcbn0pO1xuXG5ARGlyZWN0aXZlKHtcbiAgc2VsZWN0b3I6ICduZy1kcm9wZG93bixbbmdEcm9wZG93bl0sW25nLWRyb3Bkb3duXScsXG4gIGhvc3Q6IHtcbiAgICAnW2NsYXNzLnJlbmRlci1pbi1wbGFjZV0nOiAncmVuZGVySW5QbGFjZScsXG4gICAgJ1tjbGFzcy5uZy1kcm9wZG93bl0nOiAndHJ1ZSdcbiAgfSxcbiAgZXhwb3J0QXM6ICduZ0Ryb3Bkb3duJ1xufSlcbmV4cG9ydCBjbGFzcyBBbmd1bGFyRHJvcGRvd25EaXJlY3RpdmUgaW1wbGVtZW50cyBPbkNoYW5nZXMge1xuICBpZD86IHN0cmluZztcblxuICBASW5wdXQoKVxuICByZW5kZXJJblBsYWNlID0gZmFsc2U7XG5cbiAgQENvbnRlbnRDaGlsZChBbmd1bGFyRHJvcGRvd25Db250cm9sRGlyZWN0aXZlKVxuICBjb250cm9sOiBBbmd1bGFyRHJvcGRvd25Db250cm9sRGlyZWN0aXZlIHwgbnVsbCA9IG51bGw7XG5cbiAgcHJldmlvdXNWZXJ0aWNhbFBvc2l0aW9uOiBWZXJ0aWNhbFBvc2l0aW9uIHwgbnVsbCA9IG51bGw7XG4gIHByZXZpb3VzSG9yaXpvbnRhbFBvc2l0aW9uOiBIb3Jpem9udGFsUG9zaXRpb24gfCBudWxsID0gbnVsbDtcbiAgbWF0Y2hUcmlnZ2VyV2lkdGggPSBmYWxzZTtcblxuICBwcml2YXRlIF9pc09wZW4kID0gbmV3IEJlaGF2aW9yU3ViamVjdChmYWxzZSk7XG4gIGlzT3BlbiQgPSB0aGlzLl9pc09wZW4kLnBpcGUoc2tpcCgxKSk7XG5cbiAgcG9zaXRpb24kID0gbmV3IEJlaGF2aW9yU3ViamVjdDxSZWFkb25seTxEcm9wZG93bkNvbnRlbnRQb3NpdGlvbj4+KFxuICAgIEVtcHR5RHJvcGRvd25Db250ZW50UG9zaXRpb25cbiAgKTtcblxuICBnZXQgZHJvcGRvd25JZCgpIHtcbiAgICByZXR1cm4gYG5nLWRyb3Bkb3duLWNvbnRlbnQtJHt0aGlzLnVuaXF1ZUlkfWA7XG4gIH1cblxuICBASW5wdXQoKVxuICBjYWxjdWxhdGVQb3NpdGlvbjogRnVuY3Rpb24gPSBjYWxjdWxhdGVQb3NpdGlvbjtcbiAgQElucHV0KClcbiAgY2FsY3VsYXRlSW5QbGFjZVBvc2l0aW9uOiBGdW5jdGlvbiA9IGNhbGN1bGF0ZUluUGxhY2VQb3NpdGlvbjtcblxuICBASW5wdXQoKVxuICBkaXNhYmxlZCA9IGZhbHNlO1xuXG4gIEBJbnB1dCgpXG4gIGJlZm9yZU9wZW46ICgoKSA9PiBib29sZWFuIHwgT2JzZXJ2YWJsZTxib29sZWFuPikgfCBudWxsID0gbnVsbDtcblxuICBASW5wdXQoKVxuICBiZWZvcmVDbG9zZTogKCgpID0+IGJvb2xlYW4gfCBPYnNlcnZhYmxlPGJvb2xlYW4+KSB8IG51bGwgPSBudWxsO1xuXG4gIEBJbnB1dCgpXG4gIHB1YmxpYyB2ZXJ0aWNhbFBvc2l0aW9uOiBWZXJ0aWNhbFBvc2l0aW9uID0gJ2F1dG8nO1xuICBASW5wdXQoKVxuICBwdWJsaWMgaG9yaXpvbnRhbFBvc2l0aW9uOiBIb3Jpem9udGFsUG9zaXRpb24gPSAnYXV0byc7XG5cbiAgQE91dHB1dCgnb3BlbicpXG4gIG9uT3BlbiA9IHRoaXMuaXNPcGVuJC5waXBlKGZpbHRlcihvcGVuID0+IG9wZW4gPT09IHRydWUpKTtcblxuICBAT3V0cHV0KCdjbG9zZScpXG4gIG9uQ2xvc2UgPSB0aGlzLmlzT3BlbiQucGlwZShmaWx0ZXIob3BlbiA9PiBvcGVuID09PSBmYWxzZSkpO1xuXG4gIGdldCB0cmlnZ2VyRWxlbWVudCgpOiBIVE1MRWxlbWVudCB8IG51bGwge1xuICAgIHJldHVybiB0aGlzLmNvbnRyb2wgJiYgdGhpcy5jb250cm9sLmVsZW1lbnQubmF0aXZlRWxlbWVudDtcbiAgfVxuXG4gIGdldCBkcm9wZG93bkVsZW1lbnQoKTogSFRNTEVsZW1lbnQgfCBudWxsIHtcbiAgICByZXR1cm4gdGhpcy5kb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0aGlzLmRyb3Bkb3duSWQpO1xuICB9XG5cbiAgQENvbnRlbnRDaGlsZChmb3J3YXJkUmVmKCgpID0+IEFuZ3VsYXJEcm9wZG93bkNvbnRlbnRDb21wb25lbnQpKVxuICBwcml2YXRlIGRyb3Bkb3duQ29udGVudD86IEFuZ3VsYXJEcm9wZG93bkNvbnRlbnRDb21wb25lbnQ7XG5cbiAgcHJpdmF0ZSB1bmlxdWVJZDogbnVtYmVyIHwgc3RyaW5nIHwgbnVsbCA9IG51bGw7XG4gIHByaXZhdGUgd2lkdGg6IG51bWJlciB8IG51bGwgPSBudWxsO1xuICBwcml2YXRlIGRvY3VtZW50OiBEb2N1bWVudDtcblxuICBjb25zdHJ1Y3RvcihASW5qZWN0KERPQ1VNRU5UKSBkb2N1bWVudDogYW55LCBAQXR0cmlidXRlKCdpZCcpIGlkPzogc3RyaW5nKSB7XG4gICAgdGhpcy5kb2N1bWVudCA9IGRvY3VtZW50O1xuICAgIHRoaXMuaW5pdGlhbGl6ZUlkKGlkKTtcbiAgICB0aGlzLmNyZWF0ZURlZmF1bHRXb3JtaG9sZU91dGxldCgpO1xuICB9XG5cbiAgbmdPbkNoYW5nZXMoeyBkaXNhYmxlZCB9OiBTaW1wbGVDaGFuZ2VzKTogdm9pZCB7XG4gICAgaWYgKFxuICAgICAgZGlzYWJsZWQgJiZcbiAgICAgIGRpc2FibGVkLmZpcnN0Q2hhbmdlID09PSBmYWxzZSAmJlxuICAgICAgZGlzYWJsZWQuY3VycmVudFZhbHVlID09PSB0cnVlICYmXG4gICAgICBkaXNhYmxlZC5wcmV2aW91c1ZhbHVlICE9PSB0cnVlXG4gICAgKSB7XG4gICAgICB0aGlzLmRpc2FibGUoKTtcbiAgICB9XG4gIH1cblxuICBvcGVuKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmRpc2FibGVkIHx8IHRoaXMuX2lzT3BlbiQuZ2V0VmFsdWUoKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGxldCBvcGVuJCA9IG9mKHRydWUpO1xuXG4gICAgaWYgKHRoaXMuYmVmb3JlT3Blbikge1xuICAgICAgY29uc3QgcmVzdWx0ID0gdGhpcy5iZWZvcmVPcGVuKCk7XG4gICAgICBvcGVuJCA9IHJlc3VsdCBpbnN0YW5jZW9mIE9ic2VydmFibGUgPyByZXN1bHQgOiBvZihyZXN1bHQpO1xuICAgIH1cblxuICAgIG9wZW4kXG4gICAgICAucGlwZShcbiAgICAgICAgZmlyc3QoKSxcbiAgICAgICAgZmlsdGVyKG9wZW4gPT4gb3BlbiA9PT0gdHJ1ZSlcbiAgICAgIClcbiAgICAgIC5zdWJzY3JpYmUoKCkgPT4gdGhpcy5faXNPcGVuJC5uZXh0KHRydWUpKTtcbiAgfVxuXG4gIGNsb3NlKHNraXBGb2N1cyA9IGZhbHNlKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuZGlzYWJsZWQgfHwgIXRoaXMuX2lzT3BlbiQuZ2V0VmFsdWUoKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGxldCBjbG9zZSQgPSBvZih0cnVlKTtcblxuICAgIGlmICh0aGlzLmJlZm9yZUNsb3NlKSB7XG4gICAgICBjb25zdCByZXN1bHQgPSB0aGlzLmJlZm9yZUNsb3NlKCk7XG4gICAgICBjbG9zZSQgPSByZXN1bHQgaW5zdGFuY2VvZiBPYnNlcnZhYmxlID8gcmVzdWx0IDogb2YocmVzdWx0KTtcbiAgICB9XG5cbiAgICBjbG9zZSRcbiAgICAgIC5waXBlKFxuICAgICAgICBmaXJzdCgpLFxuICAgICAgICBmaWx0ZXIoY2xvc2UgPT4gY2xvc2UgPT09IHRydWUpXG4gICAgICApXG4gICAgICAuc3Vic2NyaWJlKCgpID0+IHtcbiAgICAgICAgT2JqZWN0LmFzc2lnbih0aGlzLCB7XG4gICAgICAgICAgaFBvc2l0aW9uOiBudWxsLFxuICAgICAgICAgIHZQb3NpdGlvbjogbnVsbCxcbiAgICAgICAgICB0b3A6IG51bGwsXG4gICAgICAgICAgcmlnaHQ6IG51bGwsXG4gICAgICAgICAgYm90dG9tOiBudWxsLFxuICAgICAgICAgIGxlZnQ6IG51bGwsXG4gICAgICAgICAgd2lkdGg6IG51bGwsXG4gICAgICAgICAgcHJldmlvdXNWZXJ0aWNhbFBvc2l0aW9uOiBudWxsLFxuICAgICAgICAgIHByZXZpb3VzSG9yaXpvbnRhbFBvc2l0aW9uOiBudWxsXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLl9pc09wZW4kLm5leHQoZmFsc2UpO1xuXG4gICAgICAgIGlmICghc2tpcEZvY3VzKSB7XG4gICAgICAgICAgaWYgKFxuICAgICAgICAgICAgdGhpcy50cmlnZ2VyRWxlbWVudCBpbnN0YW5jZW9mIEhUTUxFbGVtZW50ICYmXG4gICAgICAgICAgICB0aGlzLnRyaWdnZXJFbGVtZW50LnRhYkluZGV4ID4gLTFcbiAgICAgICAgICApIHtcbiAgICAgICAgICAgIHRoaXMudHJpZ2dlckVsZW1lbnQuZm9jdXMoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICB9XG5cbiAgdG9nZ2xlKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLl9pc09wZW4kLmdldFZhbHVlKCkpIHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5vcGVuKCk7XG4gICAgfVxuICB9XG5cbiAgZGlzYWJsZSgpOiB2b2lkIHtcbiAgICB0aGlzLmRpc2FibGVkID0gdHJ1ZTtcbiAgICB0aGlzLmNsb3NlKCk7XG4gIH1cblxuICBlbmFibGUoKTogdm9pZCB7XG4gICAgdGhpcy5kaXNhYmxlZCA9IGZhbHNlO1xuICB9XG5cbiAgcmVwb3NpdGlvbiA9ICgpOiBBbmd1bGFyRHJvcGRvd25Qb3NpdGlvbkNoYW5nZXMgfCBudWxsID0+IHtcbiAgICBpZiAoIXRoaXMuX2lzT3BlbiQuZ2V0VmFsdWUoKSkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgY29uc3QgZHJvcGRvd25FbGVtZW50ID0gdGhpcy5kcm9wZG93bkVsZW1lbnQ7XG4gICAgaWYgKCFkcm9wZG93bkVsZW1lbnQgfHwgIXRoaXMudHJpZ2dlckVsZW1lbnQpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIGNvbnN0IF9jYWxjdWxhdGVQb3NpdGlvbiA9IHRoaXMucmVuZGVySW5QbGFjZVxuICAgICAgPyB0aGlzLmNhbGN1bGF0ZUluUGxhY2VQb3NpdGlvblxuICAgICAgOiB0aGlzLmNhbGN1bGF0ZVBvc2l0aW9uO1xuXG4gICAgY29uc3Qgb3B0aW9ucyA9IHtcbiAgICAgIGhvcml6b250YWxQb3NpdGlvbjogdGhpcy5ob3Jpem9udGFsUG9zaXRpb24sXG4gICAgICB2ZXJ0aWNhbFBvc2l0aW9uOiB0aGlzLnZlcnRpY2FsUG9zaXRpb24sXG4gICAgICBtYXRjaFRyaWdnZXJXaWR0aDogdGhpcy5tYXRjaFRyaWdnZXJXaWR0aCxcbiAgICAgIHByZXZpb3VzSG9yaXpvbnRhbFBvc2l0aW9uOiB0aGlzLnByZXZpb3VzSG9yaXpvbnRhbFBvc2l0aW9uLFxuICAgICAgcHJldmlvdXNWZXJ0aWNhbFBvc2l0aW9uOiB0aGlzLnByZXZpb3VzVmVydGljYWxQb3NpdGlvblxuICAgIH07XG5cbiAgICBjb25zdCBwb3NpdGlvbkRhdGEgPSBfY2FsY3VsYXRlUG9zaXRpb24oXG4gICAgICB0aGlzLnRyaWdnZXJFbGVtZW50LFxuICAgICAgZHJvcGRvd25FbGVtZW50LFxuICAgICAgb3B0aW9uc1xuICAgICk7XG5cbiAgICByZXR1cm4gdGhpcy5hcHBseVJlcG9zaXRpb24oXG4gICAgICB0aGlzLnRyaWdnZXJFbGVtZW50LFxuICAgICAgZHJvcGRvd25FbGVtZW50LFxuICAgICAgcG9zaXRpb25EYXRhXG4gICAgKTtcbiAgfTtcblxuICBwcml2YXRlIGFwcGx5UmVwb3NpdGlvbihcbiAgICB0cmlnZ2VyOiBFbGVtZW50LFxuICAgIGRyb3Bkb3duOiBIVE1MRWxlbWVudCxcbiAgICBwb3NpdGlvbnM6IGFueVxuICApOiBBbmd1bGFyRHJvcGRvd25Qb3NpdGlvbkNoYW5nZXMge1xuICAgIGNvbnN0IGNoYW5nZXM6IGFueSA9IHtcbiAgICAgIGhQb3NpdGlvbjogcG9zaXRpb25zLmhvcml6b250YWxQb3NpdGlvbixcbiAgICAgIHZQb3NpdGlvbjogcG9zaXRpb25zLnZlcnRpY2FsUG9zaXRpb25cbiAgICB9O1xuICAgIGlmIChwb3NpdGlvbnMuc3R5bGUpIHtcbiAgICAgIGNoYW5nZXMudG9wID0gYCR7cG9zaXRpb25zLnN0eWxlLnRvcH1weGA7XG4gICAgICAvLyBUaGUgY29tcG9uZW50IGNhbiBiZSBhbGlnbmVkIGZyb20gdGhlIHJpZ2h0IG9yIGZyb20gdGhlIGxlZnQsIGJ1dCBub3QgZnJvbSBib3RoLlxuICAgICAgaWYgKHBvc2l0aW9ucy5zdHlsZS5sZWZ0ICE9IG51bGwpIHtcbiAgICAgICAgY2hhbmdlcy5sZWZ0ID0gYCR7cG9zaXRpb25zLnN0eWxlLmxlZnR9cHhgO1xuICAgICAgICBjaGFuZ2VzLnJpZ2h0ID0gbnVsbDtcbiAgICAgIH0gZWxzZSBpZiAocG9zaXRpb25zLnN0eWxlLnJpZ2h0ICE9IG51bGwpIHtcbiAgICAgICAgY2hhbmdlcy5yaWdodCA9IGAke3Bvc2l0aW9ucy5zdHlsZS5yaWdodH1weGA7XG4gICAgICAgIGNoYW5nZXMubGVmdCA9IG51bGw7XG4gICAgICB9XG4gICAgICBpZiAocG9zaXRpb25zLnN0eWxlLndpZHRoICE9IG51bGwpIHtcbiAgICAgICAgY2hhbmdlcy53aWR0aCA9IGAke3Bvc2l0aW9ucy5zdHlsZS53aWR0aH1weGA7XG4gICAgICB9XG4gICAgICBpZiAodGhpcy5wb3NpdGlvbiQuZ2V0VmFsdWUoKS50b3AgPT0gbnVsbCkge1xuICAgICAgICAvLyBCeXBhc3Mgb24gdGhlIGZpcnN0IHJlcG9zaXRpb24gb25seSB0byBhdm9pZCBmbGlja2VyaW5nLlxuICAgICAgICBPYmplY3Qua2V5cyhwb3NpdGlvbnMuc3R5bGUpLmZvckVhY2goXG4gICAgICAgICAgayA9PiAoZHJvcGRvd24uc3R5bGVbayBhcyBhbnldID0gcG9zaXRpb25zLnN0eWxlW2tdKVxuICAgICAgICApO1xuICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMucG9zaXRpb24kLm5leHQoY2hhbmdlcyk7XG5cbiAgICB0aGlzLnByZXZpb3VzSG9yaXpvbnRhbFBvc2l0aW9uID0gcG9zaXRpb25zLmhvcml6b250YWxQb3NpdGlvbjtcbiAgICB0aGlzLnByZXZpb3VzVmVydGljYWxQb3NpdGlvbiA9IHBvc2l0aW9ucy52ZXJ0aWNhbFBvc2l0aW9uO1xuXG4gICAgcmV0dXJuIGNoYW5nZXM7XG4gIH1cblxuICBwcml2YXRlIGluaXRpYWxpemVJZChpZD86IHN0cmluZyk6IHZvaWQge1xuICAgIGlmIChpZCkge1xuICAgICAgdGhpcy5pZCA9IHRoaXMudW5pcXVlSWQgPSBpZDtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy51bmlxdWVJZCA9IGdlbmVyYXRlRHJvcGRvd25JZCgpO1xuICAgICAgdGhpcy5pZCA9IGBuZy1kcm9wZG93bi0ke3RoaXMudW5pcXVlSWR9YDtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGNyZWF0ZURlZmF1bHRXb3JtaG9sZU91dGxldCgpOiB2b2lkIHtcbiAgICBpZiAoIXRoaXMuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25nLWRyb3Bkb3duLW91dGxldCcpKSB7XG4gICAgICBjb25zdCBvdXRsZXQgPSB0aGlzLmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgb3V0bGV0LmlkID0gJ25nLWRyb3Bkb3duLW91dGxldCc7XG4gICAgICB0aGlzLmRvY3VtZW50LmJvZHkuaW5zZXJ0QmVmb3JlKG91dGxldCwgdGhpcy5kb2N1bWVudC5ib2R5LmZpcnN0Q2hpbGQpO1xuICAgIH1cbiAgfVxufVxuIiwiaW1wb3J0IHsgU3ViamVjdCB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgdGFrZVVudGlsIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xuXG5pbXBvcnQge1xuICBDb21wb25lbnQsXG4gIElucHV0LFxuICBIb3N0LFxuICBJbmplY3QsXG4gIGZvcndhcmRSZWYsXG4gIEFmdGVyVmlld0NoZWNrZWQsXG4gIE9uSW5pdCxcbiAgT25EZXN0cm95LFxuICBOZ1pvbmVcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5cbmltcG9ydCB7IERPQ1VNRU5UIH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uJztcblxuaW1wb3J0IHsgQW5ndWxhckRyb3Bkb3duRGlyZWN0aXZlIH0gZnJvbSAnLi9hbmd1bGFyLWRyb3Bkb3duLmRpcmVjdGl2ZSc7XG5pbXBvcnQgeyBjbG9zZXN0LCB3YWl0Rm9yQW5pbWF0aW9uIH0gZnJvbSAnLi91dGlscyc7XG5cbmNvbnN0IE11dGF0aW9uT2JzZXJ2ZXIgPSAod2luZG93IGFzIGFueSkuTXV0YXRpb25PYnNlcnZlcjtcblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnbmctZHJvcGRvd24tY29udGVudCxbbmctZHJvcGRvd24tY29udGVudF0sW25nRHJvcGRvd25Db250ZW50XScsXG4gIHRlbXBsYXRlVXJsOiAnLi9hbmd1bGFyLWRyb3Bkb3duLWNvbnRlbnQuY29tcG9uZW50Lmh0bWwnLFxuICBzdHlsZVVybHM6IFsnLi9hbmd1bGFyLWRyb3Bkb3duLWNvbnRlbnQuY29tcG9uZW50LmNzcyddLFxuICBob3N0OiB7XG4gICAgJ1tjbGFzcy5yZW5kZXItaW4tcGxhY2VdJzogJ2Ryb3Bkb3duLnJlbmRlckluUGxhY2UnXG4gIH1cbn0pXG5leHBvcnQgY2xhc3MgQW5ndWxhckRyb3Bkb3duQ29udGVudENvbXBvbmVudFxuICBpbXBsZW1lbnRzIE9uSW5pdCwgQWZ0ZXJWaWV3Q2hlY2tlZCwgT25EZXN0cm95IHtcbiAgQElucHV0KClcbiAgZHJvcGRvd25DbGFzcyA9ICcnO1xuXG4gIEBJbnB1dCgpXG4gIG92ZXJsYXkgPSBmYWxzZTtcblxuICBwcml2YXRlIGhhc01vdmVkID0gZmFsc2U7XG4gIHByaXZhdGUgX2FuaW1hdGlvbkNsYXNzOiBzdHJpbmcgfCBudWxsID0gbnVsbDtcbiAgcHJpdmF0ZSBpc1RvdWNoRGV2aWNlOiBib29sZWFuID0gJ29udG91Y2hzdGFydCcgaW4gd2luZG93O1xuICBwcml2YXRlIG11dGF0aW9uT2JzZXJ2ZXI6IE11dGF0aW9uT2JzZXJ2ZXIgfCBudWxsID0gbnVsbDtcbiAgcHJpdmF0ZSBkZXN0cm95JCA9IG5ldyBTdWJqZWN0PHZvaWQ+KCk7XG5cbiAgQElucHV0KClcbiAgdHJhbnNpdGlvbmluZ0luQ2xhc3MgPSAnbmctZHJvcGRvd24tY29udGVudC0tdHJhbnNpdGlvbmluZy1pbic7XG4gIEBJbnB1dCgpXG4gIHRyYW5zaXRpb25lZEluQ2xhc3MgPSAnbmctZHJvcGRvd24tY29udGVudC0tdHJhbnNpdGlvbmVkLWluJztcbiAgQElucHV0KClcbiAgdHJhbnNpdGlvbmluZ091dENsYXNzID0gJ25nLWRyb3Bkb3duLWNvbnRlbnQtLXRyYW5zaXRpb25pbmctb3V0JztcblxuICBwcml2YXRlIGdldCBkcm9wZG93bkVsZW1lbnQoKTogSFRNTEVsZW1lbnQgfCBudWxsIHtcbiAgICByZXR1cm4gdGhpcy5kcm9wZG93bi5kcm9wZG93bkVsZW1lbnQ7XG4gIH1cblxuICBwcml2YXRlIHNob3VsZE9wZW4gPSBmYWxzZTtcbiAgcHJpdmF0ZSBkb2N1bWVudDogRG9jdW1lbnQ7XG5cbiAgY29uc3RydWN0b3IoXG4gICAgQEhvc3QoKVxuICAgIEBJbmplY3QoZm9yd2FyZFJlZigoKSA9PiBBbmd1bGFyRHJvcGRvd25EaXJlY3RpdmUpKVxuICAgIHB1YmxpYyBkcm9wZG93bjogQW5ndWxhckRyb3Bkb3duRGlyZWN0aXZlLFxuICAgIHByaXZhdGUgem9uZTogTmdab25lLFxuICAgIEBJbmplY3QoRE9DVU1FTlQpIGRvY3VtZW50OiBhbnlcbiAgKSB7XG4gICAgdGhpcy5kb2N1bWVudCA9IGRvY3VtZW50O1xuICB9XG5cbiAgbmdPbkluaXQoKTogdm9pZCB7XG4gICAgdGhpcy5kcm9wZG93bi5vbk9wZW5cbiAgICAgIC5waXBlKHRha2VVbnRpbCh0aGlzLmRlc3Ryb3kkKSlcbiAgICAgIC5zdWJzY3JpYmUoKCkgPT4gKHRoaXMuc2hvdWxkT3BlbiA9IHRydWUpKTtcblxuICAgIHRoaXMuZHJvcGRvd24ub25DbG9zZVxuICAgICAgLnBpcGUodGFrZVVudGlsKHRoaXMuZGVzdHJveSQpKVxuICAgICAgLnN1YnNjcmliZSgoKSA9PiB0aGlzLmNsb3NlKCkpO1xuICB9XG5cbiAgc2V0IGFuaW1hdGlvbkNsYXNzKGNsYXNzTmFtZTogc3RyaW5nIHwgbnVsbCkge1xuICAgIGlmICh0aGlzLmRyb3Bkb3duRWxlbWVudCAhPT0gbnVsbCkge1xuICAgICAgaWYgKHRoaXMuX2FuaW1hdGlvbkNsYXNzICYmIGNsYXNzTmFtZSAhPT0gdGhpcy5fYW5pbWF0aW9uQ2xhc3MpIHtcbiAgICAgICAgdGhpcy5kcm9wZG93bkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9hbmltYXRpb25DbGFzcyk7XG4gICAgICB9IGVsc2UgaWYgKGNsYXNzTmFtZSkge1xuICAgICAgICB0aGlzLmRyb3Bkb3duRWxlbWVudC5jbGFzc0xpc3QuYWRkKGNsYXNzTmFtZSk7XG4gICAgICB9XG4gICAgfVxuICAgIHRoaXMuX2FuaW1hdGlvbkNsYXNzID0gY2xhc3NOYW1lO1xuICB9XG5cbiAgZ2V0IGFuaW1hdGlvbkNsYXNzKCk6IHN0cmluZyB8IG51bGwge1xuICAgIHJldHVybiB0aGlzLl9hbmltYXRpb25DbGFzcztcbiAgfVxuXG4gIGdldCB0cmlnZ2VyRWxlbWVudCgpOiBFbGVtZW50IHwgbnVsbCB7XG4gICAgcmV0dXJuIHRoaXMuZHJvcGRvd24udHJpZ2dlckVsZW1lbnQ7XG4gIH1cblxuICBuZ0FmdGVyVmlld0NoZWNrZWQoKSB7XG4gICAgaWYgKHRoaXMuc2hvdWxkT3Blbikge1xuICAgICAgdGhpcy5hbmltYXRpb25DbGFzcyA9IHRoaXMudHJhbnNpdGlvbmluZ0luQ2xhc3M7XG4gICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4gdGhpcy5vcGVuKCkpO1xuICAgICAgdGhpcy5zaG91bGRPcGVuID0gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgbmdPbkRlc3Ryb3koKTogdm9pZCB7XG4gICAgdGhpcy5kZXN0cm95JC5uZXh0KCk7XG4gICAgdGhpcy50ZWFyZG93bkV2ZW50cygpO1xuICB9XG5cbiAgb3BlbigpOiB2b2lkIHtcbiAgICB0aGlzLmRvY3VtZW50LmJvZHkuYWRkRXZlbnRMaXN0ZW5lcihcbiAgICAgICdtb3VzZWRvd24nLFxuICAgICAgdGhpcy5oYW5kbGVSb290TW91c2VEb3duLFxuICAgICAgdHJ1ZVxuICAgICk7XG5cbiAgICBpZiAodGhpcy5pc1RvdWNoRGV2aWNlKSB7XG4gICAgICB0aGlzLmRvY3VtZW50LmJvZHkuYWRkRXZlbnRMaXN0ZW5lcihcbiAgICAgICAgJ3RvdWNoc3RhcnQnLFxuICAgICAgICB0aGlzLnRvdWNoU3RhcnRIYW5kbGVyLFxuICAgICAgICB0cnVlXG4gICAgICApO1xuICAgICAgdGhpcy5kb2N1bWVudC5ib2R5LmFkZEV2ZW50TGlzdGVuZXIoXG4gICAgICAgICd0b3VjaGVuZCcsXG4gICAgICAgIHRoaXMuaGFuZGxlUm9vdE1vdXNlRG93bixcbiAgICAgICAgdHJ1ZVxuICAgICAgKTtcbiAgICB9XG5cbiAgICBjb25zdCBjaGFuZ2VzID0gdGhpcy5kcm9wZG93bi5yZXBvc2l0aW9uKCk7XG4gICAgaWYgKCF0aGlzLmRyb3Bkb3duLnJlbmRlckluUGxhY2UpIHtcbiAgICAgIHRoaXMuYWRkR2xvYmFsRXZlbnRzKCk7XG4gICAgICB0aGlzLnN0YXJ0T2JzZXJ2aW5nRG9tTXV0YXRpb25zKCk7XG4gICAgfSBlbHNlIGlmIChjaGFuZ2VzICE9PSBudWxsICYmIGNoYW5nZXMudlBvc2l0aW9uID09PSAnYWJvdmUnKSB7XG4gICAgICB0aGlzLnN0YXJ0T2JzZXJ2aW5nRG9tTXV0YXRpb25zKCk7XG4gICAgfVxuXG4gICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+IHRoaXMuYW5pbWF0ZUluKCkpO1xuICB9XG5cbiAgY2xvc2UoKTogdm9pZCB7XG4gICAgdGhpcy50ZWFyZG93bkV2ZW50cygpO1xuICAgIHRoaXMuYW5pbWF0ZU91dCgpO1xuICB9XG5cbiAgcHJpdmF0ZSByZXBvc2l0aW9uSW5ab25lID0gKCkgPT5cbiAgICB0aGlzLnpvbmUucnVuKCgpID0+IHRoaXMuZHJvcGRvd24ucmVwb3NpdGlvbigpKTtcblxuICBwcml2YXRlIGFuaW1hdGVJbigpOiB2b2lkIHtcbiAgICB3YWl0Rm9yQW5pbWF0aW9uKHRoaXMuZHJvcGRvd25FbGVtZW50LCAoKSA9PiB7XG4gICAgICB0aGlzLmFuaW1hdGlvbkNsYXNzID0gdGhpcy50cmFuc2l0aW9uZWRJbkNsYXNzO1xuICAgIH0pO1xuICB9XG5cbiAgcHJpdmF0ZSBhbmltYXRlT3V0KCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmRyb3Bkb3duRWxlbWVudCA9PT0gbnVsbCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IHBhcmVudEVsZW1lbnQgPSB0aGlzLmRyb3Bkb3duLnJlbmRlckluUGxhY2VcbiAgICAgID8gdGhpcy5kcm9wZG93bkVsZW1lbnQucGFyZW50RWxlbWVudCEucGFyZW50RWxlbWVudCFcbiAgICAgIDogdGhpcy5kcm9wZG93bkVsZW1lbnQucGFyZW50RWxlbWVudCE7XG4gICAgY29uc3QgY2xvbmUgPSB0aGlzLmRyb3Bkb3duRWxlbWVudC5jbG9uZU5vZGUodHJ1ZSkgYXMgSFRNTEVsZW1lbnQ7XG4gICAgY2xvbmUuaWQgPSBgJHt0aGlzLmRyb3Bkb3duRWxlbWVudC5pZH0tLWNsb25lYDtcbiAgICBjbG9uZS5jbGFzc0xpc3QucmVtb3ZlKHRoaXMudHJhbnNpdGlvbmVkSW5DbGFzcyk7XG4gICAgY2xvbmUuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLnRyYW5zaXRpb25pbmdJbkNsYXNzKTtcbiAgICBjbG9uZS5jbGFzc0xpc3QuYWRkKHRoaXMudHJhbnNpdGlvbmluZ091dENsYXNzKTtcbiAgICBwYXJlbnRFbGVtZW50LmFwcGVuZENoaWxkKGNsb25lKTtcbiAgICB0aGlzLmFuaW1hdGlvbkNsYXNzID0gdGhpcy50cmFuc2l0aW9uaW5nSW5DbGFzcztcbiAgICB3YWl0Rm9yQW5pbWF0aW9uKGNsb25lLCAoKSA9PiBwYXJlbnRFbGVtZW50LnJlbW92ZUNoaWxkKGNsb25lKSk7XG4gIH1cblxuICBwcml2YXRlIGhhbmRsZVJvb3RNb3VzZURvd24gPSAoZTogRXZlbnQpOiB2b2lkID0+IHtcbiAgICBjb25zdCB7IHRhcmdldCB9ID0gZSBhcyBFdmVudCAmIHsgdGFyZ2V0OiBFbGVtZW50IH07XG5cbiAgICBpZiAoXG4gICAgICB0aGlzLmhhc01vdmVkIHx8XG4gICAgICAodGhpcy5kcm9wZG93bkVsZW1lbnQgIT09IG51bGwgJiZcbiAgICAgICAgdGhpcy5kcm9wZG93bkVsZW1lbnQuY29udGFpbnModGFyZ2V0KSkgfHxcbiAgICAgICh0aGlzLnRyaWdnZXJFbGVtZW50ICE9PSBudWxsICYmIHRoaXMudHJpZ2dlckVsZW1lbnQuY29udGFpbnModGFyZ2V0KSlcbiAgICApIHtcbiAgICAgIHRoaXMuaGFzTW92ZWQgPSBmYWxzZTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCBjbG9zZXN0RHJvcGRvd24gPSBjbG9zZXN0KHRhcmdldCwgJ25nLWRyb3Bkb3duLWNvbnRlbnQnKTtcbiAgICBpZiAoY2xvc2VzdERyb3Bkb3duICE9PSBudWxsKSB7XG4gICAgICBjb25zdCB0cmlnZ2VyID0gdGhpcy5kb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgICBgW2FyaWEtY29udHJvbHM9JHtjbG9zZXN0RHJvcGRvd24uZ2V0QXR0cmlidXRlKCdpZCcpfV1gXG4gICAgICApO1xuICAgICAgY29uc3QgcGFyZW50RHJvcGRvd24gPSBjbG9zZXN0KHRyaWdnZXIhLCAnbmctZHJvcGRvd24tY29udGVudCcpO1xuICAgICAgaWYgKFxuICAgICAgICBwYXJlbnREcm9wZG93biAhPT0gbnVsbCAmJlxuICAgICAgICBwYXJlbnREcm9wZG93bi5nZXRBdHRyaWJ1dGUoJ2lkJykgPT09IHRoaXMuZHJvcGRvd24uZHJvcGRvd25JZFxuICAgICAgKSB7XG4gICAgICAgIHRoaXMuaGFzTW92ZWQgPSBmYWxzZTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMuZHJvcGRvd24uY2xvc2UodHJ1ZSk7XG4gIH07XG5cbiAgcHJpdmF0ZSBzdGFydE9ic2VydmluZ0RvbU11dGF0aW9ucygpOiB2b2lkIHtcbiAgICBpZiAoTXV0YXRpb25PYnNlcnZlciAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aGlzLm11dGF0aW9uT2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcigobXV0YXRpb25zOiBhbnkpID0+IHtcbiAgICAgICAgaWYgKFxuICAgICAgICAgIG11dGF0aW9uc1swXS5hZGRlZE5vZGVzLmxlbmd0aCB8fFxuICAgICAgICAgIG11dGF0aW9uc1swXS5yZW1vdmVkTm9kZXMubGVuZ3RoXG4gICAgICAgICkge1xuICAgICAgICAgIHRoaXMucmVwb3NpdGlvbkluWm9uZSgpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHRoaXMubXV0YXRpb25PYnNlcnZlciEub2JzZXJ2ZSh0aGlzLmRyb3Bkb3duRWxlbWVudCEsIHtcbiAgICAgICAgY2hpbGRMaXN0OiB0cnVlLFxuICAgICAgICBzdWJ0cmVlOiB0cnVlXG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5kcm9wZG93bkVsZW1lbnQhLmFkZEV2ZW50TGlzdGVuZXIoXG4gICAgICAgICdET01Ob2RlSW5zZXJ0ZWQnLFxuICAgICAgICB0aGlzLnJlcG9zaXRpb25JblpvbmUsXG4gICAgICAgIGZhbHNlXG4gICAgICApO1xuICAgICAgdGhpcy5kcm9wZG93bkVsZW1lbnQhLmFkZEV2ZW50TGlzdGVuZXIoXG4gICAgICAgICdET01Ob2RlUmVtb3ZlZCcsXG4gICAgICAgIHRoaXMucmVwb3NpdGlvbkluWm9uZSxcbiAgICAgICAgZmFsc2VcbiAgICAgICk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBzdG9wT2JzZXJ2aW5nRG9tTXV0YXRpb25zKCk6IHZvaWQge1xuICAgIGlmIChNdXRhdGlvbk9ic2VydmVyKSB7XG4gICAgICBpZiAodGhpcy5tdXRhdGlvbk9ic2VydmVyKSB7XG4gICAgICAgIHRoaXMubXV0YXRpb25PYnNlcnZlci5kaXNjb25uZWN0KCk7XG4gICAgICAgIHRoaXMubXV0YXRpb25PYnNlcnZlciA9IG51bGw7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmICh0aGlzLmRyb3Bkb3duRWxlbWVudCAhPT0gbnVsbCkge1xuICAgICAgICB0aGlzLmRyb3Bkb3duRWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFxuICAgICAgICAgICdET01Ob2RlSW5zZXJ0ZWQnLFxuICAgICAgICAgIHRoaXMucmVwb3NpdGlvbkluWm9uZVxuICAgICAgICApO1xuICAgICAgICB0aGlzLmRyb3Bkb3duRWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFxuICAgICAgICAgICdET01Ob2RlUmVtb3ZlZCcsXG4gICAgICAgICAgdGhpcy5yZXBvc2l0aW9uSW5ab25lXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBhZGRHbG9iYWxFdmVudHMoKTogdm9pZCB7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsIHRoaXMucmVwb3NpdGlvbkluWm9uZSk7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIHRoaXMucmVwb3NpdGlvbkluWm9uZSk7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ29yaWVudGF0aW9uY2hhbmdlJywgdGhpcy5yZXBvc2l0aW9uSW5ab25lKTtcbiAgfVxuXG4gIHByaXZhdGUgcmVtb3ZlR2xvYmFsRXZlbnRzKCk6IHZvaWQge1xuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdzY3JvbGwnLCB0aGlzLnJlcG9zaXRpb25JblpvbmUpO1xuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdyZXNpemUnLCB0aGlzLnJlcG9zaXRpb25JblpvbmUpO1xuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdvcmllbnRhdGlvbmNoYW5nZScsIHRoaXMucmVwb3NpdGlvbkluWm9uZSk7XG4gIH1cblxuICBwcml2YXRlIHRvdWNoU3RhcnRIYW5kbGVyID0gKGU6IEV2ZW50KSA9PiB7XG4gICAgdGhpcy5kb2N1bWVudC5ib2R5LmFkZEV2ZW50TGlzdGVuZXIoXG4gICAgICAndG91Y2htb3ZlJyxcbiAgICAgIHRoaXMudG91Y2hNb3ZlSGFuZGxlcixcbiAgICAgIHRydWVcbiAgICApO1xuICB9O1xuXG4gIHByaXZhdGUgdG91Y2hNb3ZlSGFuZGxlciA9IChlOiBFdmVudCkgPT4ge1xuICAgIHRoaXMuaGFzTW92ZWQgPSB0cnVlO1xuICAgIHRoaXMuZG9jdW1lbnQuYm9keS5yZW1vdmVFdmVudExpc3RlbmVyKFxuICAgICAgJ3RvdWNobW92ZScsXG4gICAgICB0aGlzLnRvdWNoTW92ZUhhbmRsZXIsXG4gICAgICB0cnVlXG4gICAgKTtcbiAgfTtcblxuICBwcml2YXRlIHRlYXJkb3duRXZlbnRzKCkge1xuICAgIHRoaXMucmVtb3ZlR2xvYmFsRXZlbnRzKCk7XG4gICAgdGhpcy5zdG9wT2JzZXJ2aW5nRG9tTXV0YXRpb25zKCk7XG4gICAgdGhpcy5kb2N1bWVudC5ib2R5LnJlbW92ZUV2ZW50TGlzdGVuZXIoXG4gICAgICAnbW91c2Vkb3duJyxcbiAgICAgIHRoaXMuaGFuZGxlUm9vdE1vdXNlRG93bixcbiAgICAgIHRydWVcbiAgICApO1xuXG4gICAgaWYgKHRoaXMuaXNUb3VjaERldmljZSkge1xuICAgICAgdGhpcy5kb2N1bWVudC5ib2R5LnJlbW92ZUV2ZW50TGlzdGVuZXIoXG4gICAgICAgICd0b3VjaHN0YXJ0JyxcbiAgICAgICAgdGhpcy50b3VjaFN0YXJ0SGFuZGxlcixcbiAgICAgICAgdHJ1ZVxuICAgICAgKTtcbiAgICAgIHRoaXMuZG9jdW1lbnQuYm9keS5yZW1vdmVFdmVudExpc3RlbmVyKFxuICAgICAgICAndG91Y2hlbmQnLFxuICAgICAgICB0aGlzLmhhbmRsZVJvb3RNb3VzZURvd24sXG4gICAgICAgIHRydWVcbiAgICAgICk7XG4gICAgfVxuICB9XG59XG4iLCJpbXBvcnQgeyBOZ01vZHVsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgQ29tbW9uTW9kdWxlIH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uJztcblxuaW1wb3J0IHsgTmdXb3JtaG9sZU1vZHVsZSB9IGZyb20gJ25nLXdvcm1ob2xlJztcblxuaW1wb3J0IHsgQW5ndWxhckRyb3Bkb3duRGlyZWN0aXZlIH0gZnJvbSAnLi9hbmd1bGFyLWRyb3Bkb3duLmRpcmVjdGl2ZSc7XG5pbXBvcnQgeyBBbmd1bGFyRHJvcGRvd25Db250ZW50Q29tcG9uZW50IH0gZnJvbSAnLi9hbmd1bGFyLWRyb3Bkb3duLWNvbnRlbnQuY29tcG9uZW50JztcbmltcG9ydCB7IEFuZ3VsYXJEcm9wZG93bkNvbnRyb2xEaXJlY3RpdmUgfSBmcm9tICcuL2FuZ3VsYXItZHJvcGRvd24tY29udHJvbC5kaXJlY3RpdmUnO1xuXG5ATmdNb2R1bGUoe1xuICBpbXBvcnRzOiBbQ29tbW9uTW9kdWxlLCBOZ1dvcm1ob2xlTW9kdWxlXSxcbiAgZGVjbGFyYXRpb25zOiBbXG4gICAgQW5ndWxhckRyb3Bkb3duRGlyZWN0aXZlLFxuICAgIEFuZ3VsYXJEcm9wZG93bkNvbnRyb2xEaXJlY3RpdmUsXG4gICAgQW5ndWxhckRyb3Bkb3duQ29udGVudENvbXBvbmVudFxuICBdLFxuICBleHBvcnRzOiBbXG4gICAgQW5ndWxhckRyb3Bkb3duRGlyZWN0aXZlLFxuICAgIEFuZ3VsYXJEcm9wZG93bkNvbnRyb2xEaXJlY3RpdmUsXG4gICAgQW5ndWxhckRyb3Bkb3duQ29udGVudENvbXBvbmVudFxuICBdXG59KVxuZXhwb3J0IGNsYXNzIEFuZ3VsYXJEcm9wZG93bk1vZHVsZSB7fVxuIl0sIm5hbWVzIjpbIkRpcmVjdGl2ZSIsIkhvc3QiLCJJbmplY3QiLCJmb3J3YXJkUmVmIiwiRWxlbWVudFJlZiIsIkhvc3RMaXN0ZW5lciIsIkJlaGF2aW9yU3ViamVjdCIsInNraXAiLCJmaWx0ZXIiLCJvZiIsIk9ic2VydmFibGUiLCJmaXJzdCIsIkRPQ1VNRU5UIiwiQXR0cmlidXRlIiwiSW5wdXQiLCJDb250ZW50Q2hpbGQiLCJPdXRwdXQiLCJTdWJqZWN0IiwidGFrZVVudGlsIiwiQ29tcG9uZW50IiwiTmdab25lIiwiTmdNb2R1bGUiLCJDb21tb25Nb2R1bGUiLCJOZ1dvcm1ob2xlTW9kdWxlIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQUE7UUFxQ0UseUNBR1csUUFBa0MsRUFDbEMsT0FBbUI7WUFEbkIsYUFBUSxHQUFSLFFBQVEsQ0FBMEI7WUFDbEMsWUFBTyxHQUFQLE9BQU8sQ0FBWTtZQWhCOUIsbUJBQWMsR0FBWSxLQUFLLENBQUM7U0FpQi9COzs7OztRQWJELGlEQUFP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