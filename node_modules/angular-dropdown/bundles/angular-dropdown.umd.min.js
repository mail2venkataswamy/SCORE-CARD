!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("@angular/core"),require("rxjs"),require("rxjs/operators"),require("@angular/common"),require("ng-wormhole")):"function"==typeof define&&define.amd?define("angular-dropdown",["exports","@angular/core","rxjs","rxjs/operators","@angular/common","ng-wormhole"],n):n(t["angular-dropdown"]={},t.ng.core,t.rxjs,t.rxjs.operators,t.ng.common,t.ngWormhole)}(this,function(t,n,s,r,e,o){"use strict";var i=function(){function t(t,n){this.dropdown=t,this.element=n,this.isDropdownOpen=!1}return t.prototype.onClick=function(t){t.stopPropagation(),this.dropdown.disabled||this.dropdown.toggle()},t.prototype.ngOnInit=function(){var n=this;this.dropdownStateSubscription=this.dropdown.isOpen$.subscribe(function(t){return n.isDropdownOpen=t})},t.prototype.ngOnDestroy=function(){this.dropdownStateSubscription&&this.dropdownStateSubscription.unsubscribe()},t.decorators=[{type:n.Directive,args:[{selector:"[ng-dropdown-control],[ngDropdownControl]",host:{"[attr.aria-haspopup]":"true","[attr.aria-controls]":"dropdown.id","[attr.aria-expanded]":"isDropdownOpen","[class.ng-dropdown-control]":"true","[class.active]":"isDropdownOpen"}}]}],t.ctorParameters=function(){return[{type:h,decorators:[{type:n.Host},{type:n.Inject,args:[n.forwardRef(function(){return h})]}]},{type:n.ElementRef}]},t.propDecorators={onClick:[{type:n.HostListener,args:["click",["$event"]]}]},t}();function d(n,e){null!==n&&requestAnimationFrame(function(){var t=window.getComputedStyle(n);if("none"!==t.animationName&&"running"===t.animationPlayState)return function r(n,e,o){n.addEventListener(e,function i(t){return n.removeEventListener(e,i),o(t)})}(n,"animationend",e);e()})}var a="undefined"!=typeof Element&&Element.prototype.closest?function(t,n){return t.closest(n)}:function(t,n){var e,o=(t.document||t.ownerDocument).querySelectorAll(n),i=t;do{for(e=o.length;0<=--e&&o.item(e)!==i;);}while(e<0&&(i=i.parentElement));return i};function l(t,n,e){var o=e.horizontalPosition,i=e.verticalPosition,r=e.matchTriggerWidth,s=e.previousHorizontalPosition,d=e.previousVerticalPosition,a=window.pageXOffset,l=window.pageYOffset,p=t.getBoundingClientRect(),u=p.left,c=p.top,h=p.width,g=p.height,f=n.getBoundingClientRect(),v=f.height,w=f.width,m=window.innerWidth,y={};w=r?h:w,r&&(y.width=w);var b=u+a;if("auto"===o){var O=Math.min(m,u+w)-Math.max(0,u),I=Math.min(m,u+h)-Math.max(0,u+h-w);o=O<w&&O<I?"right":I<w&&I<O?"left":s||"left"}"right"===o?y.right=m-(b+h):y.left="center"===o?b+(h-w)/2:b;var P=c+l;if("above"===i)y.top=P-v;else if("below"===i)y.top=P+g;else{var E=P+g+v<l+self.window.innerHeight,C=v<c;i="below"===d&&!E&&C?"above":"above"===d&&!C&&E?"below":d||(E?"below":"above"),y.top=P+("below"===i?g:-v)}return{horizontalPosition:o,verticalPosition:i,style:y}}function p(t,n,e){var o,i=e.horizontalPosition,r=e.verticalPosition,s={};if("auto"===i){var d=t.getBoundingClientRect();o=n.getBoundingClientRect();var a=window.pageXOffset+window.innerWidth;s.horizontalPosition=d.left+o.width>a?"right":"left"}return"above"===r&&(s.verticalPosition=r,o=o||n.getBoundingClientRect(),s.style={top:-o.height}),s}var u=1;var c=Object.freeze({vPosition:null,hPosition:null,top:null,left:null,bottom:null,right:null}),h=function(){function t(t,n){var i=this;this.renderInPlace=!1,this.control=null,this.previousVerticalPosition=null,this.previousHorizontalPosition=null,this.matchTriggerWidth=!1,this._isOpen$=new s.BehaviorSubject(!1),this.isOpen$=this._isOpen$.pipe(r.skip(1)),this.position$=new s.BehaviorSubject(c),this.calculatePosition=l,this.calculateInPlacePosition=p,this.disabled=!1,this.beforeOpen=null,this.beforeClose=null,this.verticalPosition="auto",this.horizontalPosition="auto",this.onOpen=this.isOpen$.pipe(r.filter(function(t){return!0===t})),this.onClose=this.isOpen$.pipe(r.filter(function(t){return!1===t})),this.uniqueId=null,this.width=null,this.reposition=function(){if(!i._isOpen$.getValue())return null;var t=i.dropdownElement;if(!t||!i.triggerElement)return null;var n=i.renderInPlace?i.calculateInPlacePosition:i.calculatePosition,e={horizontalPosition:i.horizontalPosition,verticalPosition:i.verticalPosition,matchTriggerWidth:i.matchTriggerWidth,previousHorizontalPosition:i.previousHorizontalPosition,previousVerticalPosition:i.previousVerticalPosition},o=n(i.triggerElement,t,e);return i.applyReposition(i.triggerElement,t,o)},this.document=t,this.initializeId(n),this.createDefaultWormholeOutlet()}return Object.defineProperty(t.prototype,"dropdownId",{get:function(){return"ng-dropdown-content-"+this.uniqueId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"triggerElement",{get:function(){return this.control&&this.control.element.nativeElement},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dropdownElement",{get:function(){return this.document.getElementById(this.dropdownId)},enumerable:!0,configurable:!0}),t.prototype.ngOnChanges=function(t){var n=t.disabled;n&&!1===n.firstChange&&!0===n.currentValue&&!0!==n.previousValue&&this.disable()},t.prototype.open=function(){var t=this;if(!this.disabled&&!this._isOpen$.getValue()){var n=s.of(!0);if(this.beforeOpen){var e=this.beforeOpen();n=e instanceof s.Observable?e:s.of(e)}n.pipe(r.first(),r.filter(function(t){return!0===t})).subscribe(function(){return t._isOpen$.next(!0)})}},t.prototype.close=function(t){var n=this;if(void 0===t&&(t=!1),!this.disabled&&this._isOpen$.getValue()){var e=s.of(!0);if(this.beforeClose){var o=this.beforeClose();e=o instanceof s.Observable?o:s.of(o)}e.pipe(r.first(),r.filter(function(t){return!0===t})).subscribe(function(){Object.assign(n,{hPosition:null,vPosition:null,top:null,right:null,bottom:null,left:null,width:null,previousVerticalPosition:null,previousHorizontalPosition:null}),n._isOpen$.next(!1),t||n.triggerElement instanceof HTMLElement&&-1<n.triggerElement.tabIndex&&n.triggerElement.focus()})}},t.prototype.toggle=function(){this._isOpen$.getValue()?this.close():this.open()},t.prototype.disable=function(){this.disabled=!0,this.close()},t.prototype.enable=function(){this.disabled=!1},t.prototype.applyReposition=function(t,n,e){var o={hPosition:e.horizontalPosition,vPosition:e.verticalPosition};return e.style&&(o.top=e.style.top+"px",null!=e.style.left?(o.left=e.style.left+"px",o.right=null):null!=e.style.right&&(o.right=e.style.right+"px",o.left=null),null!=e.style.width&&(o.width=e.style.width+"px"),null==this.position$.getValue().top&&Object.keys(e.style).forEach(function(t){return n.style[t]=e.style[t]})),this.position$.next(o),this.previousHorizontalPosition=e.horizontalPosition,this.previousVerticalPosition=e.verticalPosition,o},t.prototype.initializeId=function(t){this.id=t?this.uniqueId=t:(this.uniqueId=function n(){return u++}(),"ng-dropdown-"+this.uniqueId)},t.prototype.createDefaultWormholeOutlet=function(){if(!this.document.getElementById("ng-dropdown-outlet")){var t=this.document.createElement("div");t.id="ng-dropdown-outlet",this.document.body.insertBefore(t,this.document.body.firstChild)}},t.decorators=[{type:n.Directive,args:[{selector:"ng-dropdown,[ngDropdown],[ng-dropdown]",host:{"[class.render-in-place]":"renderInPlace","[class.ng-dropdown]":"true"},exportAs:"ngDropdown"}]}],t.ctorParameters=function(){return[{type:undefined,decorators:[{type:n.Inject,args:[e.DOCUMENT]}]},{type:String,decorators:[{type:n.Attribute,args:["id"]}]}]},t.propDecorators={renderInPlace:[{type:n.Input}],control:[{type:n.ContentChild,args:[i]}],calculatePosition:[{type:n.Input}],calculateInPlacePosition:[{type:n.Input}],disabled:[{type:n.Input}],beforeOpen:[{type:n.Input}],beforeClose:[{type:n.Input}],verticalPosition:[{type:n.Input}],horizontalPosition:[{type:n.Input}],onOpen:[{type:n.Output,args:["open"]}],onClose:[{type:n.Output,args:["close"]}],dropdownContent:[{type:n.ContentChild,args:[n.forwardRef(function(){return f})]}]},t}(),g=window.MutationObserver,f=function(){function t(t,n,e){var r=this;this.dropdown=t,this.zone=n,this.dropdownClass="",this.overlay=!1,this.hasMoved=!1,this._animationClass=null,this.isTouchDevice="ontouchstart"in window,this.mutationObserver=null,this.destroy$=new s.Subject,this.transitioningInClass="ng-dropdown-content--transitioning-in",this.transitionedInClass="ng-dropdown-content--transitioned-in",this.transitioningOutClass="ng-dropdown-content--transitioning-out",this.shouldOpen=!1,this.repositionInZone=function(){return r.zone.run(function(){return r.dropdown.reposition()})},this.handleRootMouseDown=function(t){var n=t.target;if(r.hasMoved||null!==r.dropdownElement&&r.dropdownElement.contains(n)||null!==r.triggerElement&&r.triggerElement.contains(n))r.hasMoved=!1;else{var e=a(n,"ng-dropdown-content");if(null!==e){var o=r.document.querySelector("[aria-controls="+e.getAttribute("id")+"]"),i=a(o,"ng-dropdown-content");if(null!==i&&i.getAttribute("id")===r.dropdown.dropdownId)return void(r.hasMoved=!1)}r.dropdown.close(!0)}},this.touchStartHandler=function(t){r.document.body.addEventListener("touchmove",r.touchMoveHandler,!0)},this.touchMoveHandler=function(t){r.hasMoved=!0,r.document.body.removeEventListener("touchmove",r.touchMoveHandler,!0)},this.document=e}return Object.defineProperty(t.prototype,"dropdownElement",{get:function(){return this.dropdown.dropdownElement},enumerable:!0,configurable:!0}),t.prototype.ngOnInit=function(){var t=this;this.dropdown.onOpen.pipe(r.takeUntil(this.destroy$)).subscribe(function(){return t.shouldOpen=!0}),this.dropdown.onClose.pipe(r.takeUntil(this.destroy$)).subscribe(function(){return t.close()})},Object.defineProperty(t.prototype,"animationClass",{get:function(){return this._animationClass},set:function(t){null!==this.dropdownElement&&(this._animationClass&&t!==this._animationClass?this.dropdownElement.classList.remove(this._animationClass):t&&this.dropdownElement.classList.add(t)),this._animationClass=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"triggerElement",{get:function(){return this.dropdown.triggerElement},enumerable:!0,configurable:!0}),t.prototype.ngAfterViewChecked=function(){var t=this;this.shouldOpen&&(this.animationClass=this.transitioningInClass,requestAnimationFrame(function(){return t.open()}),this.shouldOpen=!1)},t.prototype.ngOnDestroy=function(){this.destroy$.next(),this.teardownEvents()},t.prototype.open=function(){var t=this;this.document.body.addEventListener("mousedown",this.handleRootMouseDown,!0),this.isTouchDevice&&(this.document.body.addEventListener("touchstart",this.touchStartHandler,!0),this.document.body.addEventListener("touchend",this.handleRootMouseDown,!0));var n=this.dropdown.reposition();this.dropdown.renderInPlace?null!==n&&"above"===n.vPosition&&this.startObservingDomMutations():(this.addGlobalEvents(),this.startObservingDomMutations()),requestAnimationFrame(function(){return t.animateIn()})},t.prototype.close=function(){this.teardownEvents(),this.animateOut()},t.prototype.animateIn=function(){var t=this;d(this.dropdownElement,function(){t.animationClass=t.transitionedInClass})},t.prototype.animateOut=function(){if(null!==this.dropdownElement){var t=this.dropdown.renderInPlace?this.dropdownElement.parentElement.parentElement:this.dropdownElement.parentElement,n=this.dropdownElement.cloneNode(!0);n.id=this.dropdownElement.id+"--clone",n.classList.remove(this.transitionedInClass),n.classList.remove(this.transitioningInClass),n.classList.add(this.transitioningOutClass),t.appendChild(n),this.animationClass=this.transitioningInClass,d(n,function(){return t.removeChild(n)})}},t.prototype.startObservingDomMutations=function(){var n=this;g!==undefined?(this.mutationObserver=new g(function(t){(t[0].addedNodes.length||t[0].removedNodes.length)&&n.repositionInZone()}),this.mutationObserver.observe(this.dropdownElement,{childList:!0,subtree:!0})):(this.dropdownElement.addEventListener("DOMNodeInserted",this.repositionInZone,!1),this.dropdownElement.addEventListener("DOMNodeRemoved",this.repositionInZone,!1))},t.prototype.stopObservingDomMutations=function(){g?this.mutationObserver&&(this.mutationObserver.disconnect(),this.mutationObserver=null):null!==this.dropdownElement&&(this.dropdownElement.removeEventListener("DOMNodeInserted",this.repositionInZone),this.dropdownElement.removeEventListener("DOMNodeRemoved",this.repositionInZone))},t.prototype.addGlobalEvents=function(){window.addEventListener("scroll",this.repositionInZone),window.addEventListener("resize",this.repositionInZone),window.addEventListener("orientationchange",this.repositionInZone)},t.prototype.removeGlobalEvents=function(){window.removeEventListener("scroll",this.repositionInZone),window.removeEventListener("resize",this.repositionInZone),window.removeEventListener("orientationchange",this.repositionInZone)},t.prototype.teardownEvents=function(){this.removeGlobalEvents(),this.stopObservingDomMutations(),this.document.body.removeEventListener("mousedown",this.handleRootMouseDown,!0),this.isTouchDevice&&(this.document.body.removeEventListener("touchstart",this.touchStartHandler,!0),this.document.body.removeEventListener("touchend",this.handleRootMouseDown,!0))},t.decorators=[{type:n.Component,args:[{selector:"ng-dropdown-content,[ng-dropdown-content],[ngDropdownContent]",template:'<ng-container *ngIf="dropdown.isOpen$ | async as isOpen">\n  <ng-container *ngWormhole="\'#ng-dropdown-outlet\'; renderInPlace: dropdown.renderInPlace">\n    <div *ngIf="overlay && isOpen" class="ng-dropdown-overlay"></div>\n    <div [id]="dropdown.dropdownId"\n        class="ng-dropdown-content {{dropdownClass}}"\n        [style.top]="(dropdown.position$ | async)?.top"\n        [style.right]="(dropdown.position$ | async)?.right"\n        [style.bottom]="(dropdown.position$ | async)?.bottom"\n        [style.left]="(dropdown.position$ | async)?.left"\n        [class.render-in-place]="dropdown.renderInPlace"\n        [class.ng-dropdown-content--above]="(dropdown.position$ | async)?.vPosition === \'above\'"\n        [class.ng-dropdown-content--below]="(dropdown.position$ | async)?.vPosition === \'below\'"\n        [class.ng-dropdown-content--right]="(dropdown.position$ | async)?.hPosition === \'right\'"\n        [class.ng-dropdown-content--center]="(dropdown.position$ | async)?.hPosition === \'center\'"\n        [class.ng-dropdown-content--left]="(dropdown.position$ | async)?.hPosition === \'left\'">\n      <ng-content></ng-content>\n    </div>\n  </ng-container>\n  <div *ngIf="!isOpen" [id]="dropdown.dropdownId" class="ng-dropdown-placeholder"></div>\n</ng-container>\n',host:{"[class.render-in-place]":"dropdown.renderInPlace"},styles:[":host{display:none}:host.render-in-place{display:block;position:absolute}"]}]}],t.ctorParameters=function(){return[{type:h,decorators:[{type:n.Host},{type:n.Inject,args:[n.forwardRef(function(){return h})]}]},{type:n.NgZone},{type:undefined,decorators:[{type:n.Inject,args:[e.DOCUMENT]}]}]},t.propDecorators={dropdownClass:[{type:n.Input}],overlay:[{type:n.Input}],transitioningInClass:[{type:n.Input}],transitionedInClass:[{type:n.Input}],transitioningOutClass:[{type:n.Input}]},t}(),v=function(){function t(){}return t.decorators=[{type:n.NgModule,args:[{imports:[e.CommonModule,o.NgWormholeModule],declarations:[h,i,f],exports:[h,i,f]}]}],t}();t.AngularDropdownContentComponent=f,t.AngularDropdownControlDirective=i,t.AngularDropdownDirective=h,t.AngularDropdownModule=v,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=angular-dropdown.umd.min.js.map